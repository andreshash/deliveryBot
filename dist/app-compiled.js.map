{"version":3,"sources":["app.js"],"names":[],"mappings":"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","file":"app-compiled.js","sourcesContent":["'use strict';\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _underscore = require('underscore');\n\nvar _ = _interopRequireWildcard(_underscore);\n\nvar _bot = require('./bot');\n\nvar bot = _interopRequireWildcard(_bot);\n\nvar _actionTypes = require('./constants/actionTypes');\n\nvar types = _interopRequireWildcard(_actionTypes);\n\nvar _index = require('./actions/index');\n\nvar Actions = _interopRequireWildcard(_index);\n\nvar _ParseModels = require('./ParseModels');\n\nvar ParseModels = _interopRequireWildcard(_ParseModels);\n\nvar _ParseUtils = require('./ParseUtils');\n\nvar _redux = require('redux');\n\nvar _config = require('config');\n\nvar _config2 = _interopRequireDefault(_config);\n\nvar _request = require('request');\n\nvar _request2 = _interopRequireDefault(_request);\n\nvar _hashmap = require('hashmap');\n\nvar _hashmap2 = _interopRequireDefault(_hashmap);\n\nvar _objectAssign = require('object-assign');\n\nvar _objectAssign2 = _interopRequireDefault(_objectAssign);\n\nvar _fb = require('fb');\n\nvar _fb2 = _interopRequireDefault(_fb);\n\nvar _reduxThunk = require('redux-thunk');\n\nvar _reduxThunk2 = _interopRequireDefault(_reduxThunk);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nvar APP_SECRET = process.env.MESSENGER_APP_SECRET ? process.env.MESSENGER_APP_SECRET : _config2.default.get('APP_SECRET');\n\nvar PAGE_ACCESS_TOKEN = process.env.MESSENGER_PAGE_ACCESS_TOKEN ? process.env.MESSENGER_PAGE_ACCESS_TOKEN : _config2.default.get('PAGE_ACCESS_TOKEN');\n\nvar PARSE_APP_ID = process.env.PARSE_APP_ID ? process.env.PARSE_APP_ID : _config2.default.get('PARSE_APP_ID');\n\nvar PARSE_SERVER_URL = process.env.PARSE_SERVER_URL ? process.env.PARSE_SERVER_URL : _config2.default.get('PARSE_SERVER_URL');\n\nvar PARSE_CLIENT_KEY = process.env.PARSE_CLIENT_KEY ? process.env.PARSE_CLIENT_KEY : _config2.default.get('PARSE_CLIENT_KEY');\n\nvar FACEBOOK_APP_ID = process.env.FACEBOOK_APP_ID ? process.env.FACEBOOK_APP_ID : _config2.default.get('FACEBOOK_APP_ID');\n\nvar REDIRECT_URI = process.env.REDIRECT_URI ? process.env.REDIRECT_URI : _config2.default.get('REDIRECT_URI');\n\nvar BUSINESS_ID = process.env.BUSINESS_ID ? process.env.BUSINESS_ID : _config2.default.get('BUSINESS_ID');\n\n_fb2.default.options({\n    appId: FACEBOOK_APP_ID,\n    appSecret: APP_SECRET,\n    redirectUri: REDIRECT_URI\n});\n\nbot.rules.set('hola', sendMenu);\nbot.rules.set('buenos dias', sendMenu);\nbot.rules.set('buenos tardes', sendMenu);\nbot.rules.set('pedir domicilio', sendAddressMenu);\nbot.rules.set('cuenta', sendShoppingCart);\n\nbot.payloadRules.set('Greeting', sendMenu);\nbot.payloadRules.set('SendAddressMenu', sendAddressMenu);\nbot.payloadRules.set('SetAddress', setAddress);\nbot.payloadRules.set('NewAddress', newAddress);\nbot.payloadRules.set('WriteAddress', writeAddress);\nbot.payloadRules.set('SetLocation', setLocation);\nbot.payloadRules.set('SendCategories', sendCategories);\nbot.payloadRules.set('SendProducts', sendProducts);\nbot.payloadRules.set('AddProduct', addProduct);\nbot.payloadRules.set('SendShoppingCart', sendShoppingCart);\nbot.payloadRules.set('SendPurchaseOptions', sendPurchaseOptions);\nbot.payloadRules.set('Checkout', checkout);\nbot.payloadRules.set('CreditCard', checkCreditCard);\nbot.payloadRules.set('RegisterCreditCard', registerCreditCard);\nbot.payloadRules.set('ConfirmRegisterCreditCard', confirmRegisterCreditCard);\nbot.payloadRules.set('CancelRegisterCreditCard', cancelRegisterCreditCard);\nbot.payloadRules.set('PayWithCreditCard', payWithCreditCard);\nbot.payloadRules.set('SetRating', setRating);\n\nvar initialState = {\n    geocodedLocation: { lat: -1, lng: -1 },\n    addresses: [],\n    mapBounds: {},\n    mapAddress: '',\n    useSubCategories: false,\n    products: [],\n    pointOfSales: [],\n    categories: [],\n    paymentMethods: [],\n    consumer: {},\n    customer: {},\n    orders: { ongoing: [], delivered: [] },\n    orderToRate: null,\n    currentOrder: {\n        consumerAddress: {},\n        items: []\n    },\n    locationZoom: 3,\n    profileIsOpen: false,\n    mapAddressIsOpen: false,\n    addressFormIsOpen: false,\n    addressListIsOpen: false,\n    savingAddress: false,\n    creatingOrder: false,\n    paymentMethodNotSelected: false,\n    cartTotalIsBelowMinimumPrice: false,\n    currentCategory: {},\n    consumerNotFound: false,\n    updatingConsumer: false,\n    currentUser: {},\n    pendingOrder: false\n};\n\nvar reducer = function reducer() {\n    var state = arguments.length <= 0 || arguments[0] === undefined ? initialState : arguments[0];\n    var action = arguments[1];\n\n    console.log('ACTION');\n    console.log(action);\n    var item = void 0;\n    switch (action.type) {\n        case types.APP_LOADED:\n            console.log('Application is running on port', bot.app.get('port'));\n            return _extends({}, state);\n        case types.CONSUMER_UPDATED:\n            return _extends({}, state);\n        case types.CONSUMER_LOADED:\n            if (state.consumerNotFound) delete state.consumerNotFound;\n            var consumer = (0, _ParseUtils.extractParseAttributes)(action.data.consumer);\n            //objectAssign(state.consumerAddress, {consumer})\n            (0, _objectAssign2.default)(state, { consumer: consumer, currentUser: action.data.user });\n            return _extends({}, state);\n        case types.CONSUMER_NOT_FOUND:\n            (0, _objectAssign2.default)(state, {\n                consumerNotFound: true,\n                currentUser: action.data.user\n            });\n            return _extends({}, state);\n        case types.CONSUMER_ADDRESSES_LOADED:\n            var addresses = action.data.map(function (a) {\n                return (0, _ParseUtils.extractParseAttributes)(a);\n            });\n            (0, _objectAssign2.default)(state, { addresses: addresses });\n            return _extends({}, state);\n        case types.CONSUMER_ORDERS_LOADED:\n            var orders = action.data;\n            var ongoing = orders['ongoing'].map(function (o) {\n                return (0, _ParseUtils.extractParseAttributes)(o);\n            });\n            var delivered = orders['delivered'].map(function (o) {\n                return (0, _ParseUtils.extractParseAttributes)(o);\n            });\n            var orderToRate = delivered[0];\n            (0, _objectAssign2.default)(state, {\n                orders: { ongoing: ongoing, delivered: delivered },\n                orderToRate: orderToRate\n            });\n            return _extends({}, state);\n        case types.CUSTOMER_LOADED:\n            var customer = (0, _ParseUtils.extractParseAttributes)(action.data.customer);\n            (0, _objectAssign2.default)(state, { customer: customer });\n            return _extends({}, state);\n        case types.RENDER_MENU:\n            /*\n            console.log('Store');\n            console.log(store.getState())\n            console.log('Consumer');\n            console.log(consumer);*/\n            renderMenuMessage();\n\n            /*request({\n             uri: 'https://graph.facebook.com/v2.6/' + '1100195690052041',\n             qs: {access_token: PAGE_ACCESS_TOKEN, fields: 'first_name,last_name,locale,timezone,gender'},\n             method: 'GET'\n             }, renderMenuMessage);*/\n\n            return state;\n        case types.RENDER_ADDRESS_MENU:\n\n            renderAddressMenuMessage();\n\n            return state;\n        default:\n            return state;\n    }\n};\n\nvar store = (0, _redux.createStore)(reducer, (0, _redux.applyMiddleware)(_reduxThunk2.default));\n\nstore.subscribe(function () {\n    return console.log('\\n');\n} //store.getState())\n);\n\n//global.FB = FB;\n\nfunction authentication(recipientId, callback) {\n    new Parse.Query(ParseModels.User).equalTo('facebookId', recipientId).first().then(function (user) {\n        if (user) {\n            if (callback) {\n                callback(user);\n            }\n        } else {\n            bot.getFacebookUser(recipientId, function (userData) {\n                signup(recipientId, userData, callback);\n            });\n        }\n    }, function (object, error) {\n        console.log(error);\n    });\n}\n\nfunction signup(facebookId, userData, callback) {\n    //1100195690052041\n    if (userData) {\n        var facebookUser = new ParseModels.User();\n        facebookUser.save(Object.assign(userData, { username: facebookId.toString(), password: facebookId.toString(), facebookId: facebookId }), {\n            success: function success(user) {\n                var consumer = new ParseModels.Consumer();\n                consumer.set('name', user.get('first_name') + \" \" + user.get('last_name'));\n                consumer.set('user', {\n                    __type: \"Pointer\",\n                    className: \"_User\",\n                    objectId: user.id\n                });\n                consumer.save(undefined, {\n                    success: function success(consumer) {\n                        sendRegisterFacebookUser(facebookId);\n                        callback(user);\n                    },\n                    error: function error(user, _error) {\n                        // Execute any logic that should take place if the save fails.\n                        // error is a Parse.Error with an error code and message.\n                        console.log('Failed to create new object, with error code: ' + _error.message);\n                    }\n                });\n            },\n            error: function error(user, _error2) {\n                // Execute any logic that should take place if the save fails.\n                // error is a Parse.Error with an error code and message.\n                console.log('Failed to create new object, with error code: ' + _error2.message);\n            }\n        });\n    }\n}\n\nfunction sendRegisterFacebookUser(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Registro exitoso.\"\n\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction sendMenu(recipientId) {\n    bot.sendTypingOn(recipientId);\n    recipientId = parseInt(recipientId);\n\n    authentication(recipientId, function (user) {\n        if (user) {\n            store.dispatch(Actions.loadCustomer(BUSINESS_ID)).then(function () {\n                store.dispatch(Actions.loadConsumer(user)).then(function () {\n                    renderMenuMessage(recipientId);\n                });\n            });\n        } else {\n            var messageData = {\n                recipient: {\n                    id: recipientId\n                },\n                message: {\n                    \"text\": \"Usuario no registrado en el sistema, informacion obtenida: first_name, last_name, locale, timezone, gender\"\n                }\n            };\n\n            bot.sendTypingOff(recipientId);\n            bot.callSendAPI(messageData);\n        }\n    });\n}\n\nfunction renderMenuMessage(recipientId) {\n    var consumer = store.getState().consumer;\n    var customer = store.getState().customer;\n\n    //var currentUser = Parse.User.current();\n\n    var image_url = customer.image.url;\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            attachment: {\n                type: \"template\",\n                payload: {\n                    template_type: \"generic\",\n                    //text: \"Buenos dias, para conocer nuestros menus del dia, por favor escoja una opción:\",\n                    elements: [{\n                        \"title\": \"Hola \" + consumer.name + \", Bienvenido a OXXO. \",\n                        \"subtitle\": \"Aquí puedes pedir un domicilio, escribe o selecciona alguna de las opciones:\",\n                        \"image_url\": image_url,\n                        \"buttons\": [{\n                            \"type\": \"postback\",\n                            \"title\": \"Pedir domicilio\",\n                            \"payload\": \"SendAddressMenu\"\n                        }, {\n                            \"type\": \"postback\",\n                            \"title\": \"Pedir para recoger\",\n                            \"payload\": \"TakeOut\"\n                        }, {\n                            \"type\": \"postback\",\n                            \"title\": \"Servicio al cliente\",\n                            \"payload\": \"CustomerService\"\n                        }]\n                    }]\n                }\n            }\n        }\n    };\n\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction sendAddressMenu(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var consumer = store.getState().consumer;\n    recipientId = parseInt(recipientId);\n\n    if (!_.isEmpty(consumer)) {\n        store.dispatch(Actions.loadConsumerAddresses(consumer.rawParseObject)).then(function () {\n            renderAddressMenuMessage(recipientId);\n        });\n    } else {\n        store.dispatch(Actions.loadCustomer(BUSINESS_ID)).then(function () {\n            authentication(recipientId, function (user) {\n                if (user) {\n                    store.dispatch(Actions.loadConsumer(user)).then(function () {\n                        consumer = store.getState().consumer;\n                        store.dispatch(Actions.loadConsumerAddresses(consumer.rawParseObject)).then(function () {\n                            renderAddressMenuMessage(recipientId);\n                        });\n                    });\n                }\n            });\n        });\n    }\n}\n\nfunction renderAddressMenuMessage(recipientId) {\n    var addresses = store.getState().addresses;\n    var quick_replies = [];\n\n    console.log(addresses);\n    console.log(addresses.length);\n\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n        for (var _iterator = addresses[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            var address = _step.value;\n\n            if (quick_replies.length <= bot.limit) console.log(address);\n            quick_replies.push({\n                \"content_type\": \"text\",\n                \"title\": address.name,\n                \"payload\": \"SetAddress-\" + address.id //\"SetAddress-Office\"\n            });\n        }\n    } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n    } finally {\n        try {\n            if (!_iteratorNormalCompletion && _iterator.return) {\n                _iterator.return();\n            }\n        } finally {\n            if (_didIteratorError) {\n                throw _iteratorError;\n            }\n        }\n    }\n\n    quick_replies.push({\n        \"content_type\": \"text\",\n        \"title\": \"Nueva dirección\",\n        \"payload\": \"NewAddress\"\n    });\n\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"A cual dirección vas hacer tu pedido?\\n\\nPuedes escoger entre tus direcciones guardadas o agregar una nueva dirección\", //puedes escoger entre tus direcciones almacenadas o registrar una nueva\n            \"quick_replies\": quick_replies\n        }\n    };\n\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction setAddress(recipientId, args) {\n    bot.sendTypingOn(recipientId);\n    renderAddressConfirmation(recipientId);\n}\n\nfunction newAddress(recipientId) {\n    bot.sendTypingOff(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Deseas escribir o enviar tu ubicación actual?\",\n            \"quick_replies\": [{\n                \"content_type\": \"text\",\n                \"title\": \"Escribir dirección\",\n                \"payload\": \"WriteAddress\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"Enviar ubicación\",\n                \"payload\": \"SetLocation\"\n            }]\n        }\n    };\n    bot.callSendAPI(messageData);\n}\n\nfunction writeAddress(recipientId) {\n    bot.sendTypingOff(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Por favor escribe tu dirección actual. \\n\\nEjemplo: Calle 67 #52-20, Medellín, Antioquia, Colombia\"\n        }\n    };\n    bot.listenData(recipientId, 'address');\n    bot.callSendAPI(messageData);\n}\n\nfunction setLocation(recipientId) {\n    bot.sendTypingOff(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Por favor confirma el envio de tu dirección actual\",\n            \"quick_replies\": [{\n                \"content_type\": \"location\"\n            }]\n        }\n    };\n    bot.callSendAPI(messageData);\n}\n\nfunction renderAddressConfirmation(recipientId) {\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Perfecto, ya guardé tu dirección para próximos pedidos\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData, sendCategories);\n}\n\nfunction renderCategoriesInitialMessage(recipientId) {\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"A continuación te presentamos las categorías de productos disponibles.\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction sendCategories(recipientId, catIdx) {\n    bot.sendTypingOn(recipientId);\n\n    if (catIdx == undefined) catIdx = 0;else if (typeof catIdx == 'string') catIdx = parseInt(catIdx);\n\n    if (catIdx == 0) {\n        renderCategoriesInitialMessage(recipientId);\n        bot.sendTypingOn(recipientId);\n    }\n\n    Parse.Cloud.run('getProducts', { businessId: BUSINESS_ID }).then(function (result) {\n\n        var elements = splitCategories(result.categories, catIdx);\n        var idx = Object.keys(result.categories).length;\n        var buttons = [];\n        var catIni = (catIdx + 1) * bot.limit;\n        var catFin = idx > catIni + bot.limit ? catIni + bot.limit : idx;\n        /*\n        console.log('length: '+idx);\n        console.log('catIni: '+catIni);\n        console.log('catFin: '+catFin);\n        console.log('limit: '+(catIdx+1)*bot.limit);\n        */\n        if (idx > (catIdx + 1) * bot.limit) {\n            buttons.push({\n                type: \"postback\",\n                title: \"Categorias \" + (catIni + 1) + \"-\" + catFin,\n                payload: \"SendCategories-\" + (catIdx + 1)\n            });\n\n            elements.push({\n                title: \"Ver más categorias \",\n                subtitle: \"Categorias disponibles\",\n                buttons: buttons\n            });\n        }\n\n        var messageData = {\n            recipient: {\n                id: recipientId\n            },\n            message: {\n                attachment: {\n                    type: \"template\",\n                    payload: {\n                        template_type: \"generic\",\n                        elements: elements\n                    }\n                }\n            }\n        };\n\n        bot.sendTypingOff(recipientId);\n        bot.callSendAPI(messageData);\n    }, function (error) {});\n}\n\nfunction splitCategories(categories, catIdx) {\n    var idx = 0;\n    var elements = [];\n\n    categories.forEach(function (item) {\n        //console.log(item.get('name'));\n        if (item && item.get('name')) {\n            //console.log(elements.length);\n            if (idx >= catIdx * bot.limit && idx < (catIdx + 1) * bot.limit) {\n                var image = item.get('image');\n                var image_url = \"http://pro.parse.inoutdelivery.com/parse/files/hSMaiK7EXqDqRVYyY2fjIp4lBweiZnjpEmhH4LpJ/2671158f9c1cb43cac1423101b6e451b_image.txt\";\n                if (image) {\n                    image_url = image.url();\n                }\n                elements.push({\n                    title: item.get('name'),\n                    //subtitle: item.get('name'),\n                    //item_url: \"http://www.mycolombianrecipes.com/fruit-cocktail-salpicon-de-frutas\",\n                    image_url: image_url,\n                    buttons: [{\n                        type: \"postback\",\n                        title: item.get('name'),\n                        payload: \"SendProducts-\" + item.id + \"-\" + catIdx\n                    }]\n                });\n            }\n            idx = idx + 1;\n        }\n    });\n    return elements;\n}\n\nfunction renderProductsInitialMessage(recipientId, categoryId) {\n    return new Parse.Query(ParseModels.Category).get(categoryId).then(function (category) {\n        var messageData = {\n            recipient: {\n                id: recipientId\n            },\n            message: {\n                text: \"Tenemos los siguientes \" + category.get('name') + \":\"\n            }\n        };\n        bot.sendTypingOff(recipientId);\n        bot.callSendAPI(messageData);\n    }, function (object, error) {\n        console.log(error);\n        // error is an instance of Parse.Error.\n    });\n}\n\nfunction sendProducts(recipientId, category, proIdx) {\n    bot.sendTypingOn(recipientId);\n    proIdx = parseInt(proIdx);\n    if (proIdx == 0) {\n        renderProductsInitialMessage(recipientId, category);\n        bot.sendTypingOn(recipientId);\n    }\n\n    Parse.Cloud.run('getProducts', { businessId: BUSINESS_ID, category: category }).then(function (result) {\n        var elements = splitProducts(result.products, proIdx);\n        var idx = Object.keys(result.products).length;\n        var buttons = [];\n        var catIni = (proIdx + 1) * bot.limit;\n        var catFin = idx > catIni + bot.limit ? catIni + bot.limit : idx;\n        /*\n        console.log('length: '+idx);\n        console.log('catIni: '+catIni);\n        console.log('catFin: '+catFin);\n        console.log('limit: '+(proIdx+1)*bot.limit);\n        */\n        if (idx > (proIdx + 1) * bot.limit) {\n            buttons.push({\n                type: \"postback\",\n                title: \"Productos \" + (catIni + 1) + \"-\" + catFin,\n                payload: \"SendProducts-\" + category + \"-\" + (proIdx + 1)\n            });\n\n            elements.push({\n                title: \"Ver más productos \",\n                subtitle: \"Productos disponibles\",\n                buttons: buttons\n            });\n        }\n\n        var messageData = {\n            recipient: {\n                id: recipientId\n            },\n            message: {\n                attachment: {\n                    type: \"template\",\n                    payload: {\n                        template_type: \"generic\",\n                        elements: elements\n                    }\n                }\n            }\n        };\n\n        bot.sendTypingOff(recipientId);\n        bot.callSendAPI(messageData);\n    }, function (error) {});\n}\n\nfunction splitProducts(products, proIdx) {\n    var idx = 0;\n    var elements = [];\n\n    products.forEach(function (item) {\n        if (item && item.get('name')) {\n            if (idx >= proIdx * bot.limit && idx < (proIdx + 1) * bot.limit) {\n                var image = item.get('image');\n                var image_url = \"http://pro.parse.inoutdelivery.com/parse/files/hSMaiK7EXqDqRVYyY2fjIp4lBweiZnjpEmhH4LpJ/2671158f9c1cb43cac1423101b6e451b_image.txt\";\n                if (image) {\n                    image_url = image.url();\n                }\n                elements.push({\n                    title: item.get('name') + \": $\" + item.get('priceDefault'),\n                    subtitle: item.get('description'),\n                    //item_url: \"http://www.mycolombianrecipes.com/fruit-cocktail-salpicon-de-frutas\",\n                    image_url: image_url,\n                    buttons: [{\n                        type: \"postback\",\n                        title: \"Agregar\",\n                        payload: \"AddProduct-\" + item.id\n                    }]\n                });\n            }\n            idx = idx + 1;\n        }\n    });\n    return elements;\n}\n\nfunction addProduct(recipientId, productId) {\n    //console.log(\"Add product: \"+productId);\n    //console.log(\"Order.count: \"+order.count());\n    if (!order.get(productId)) {\n        order.set(productId, 1);\n    } else {\n        order.set(productId, order.get(productId) + 1);\n    }\n    renderAddProductConfirmation(recipientId, productId);\n}\n\nfunction renderAddProductConfirmation(recipientId, productId) {\n    return new Parse.Query(ParseModels.Product).get(productId).then(function (product) {\n        var messageData = {\n            recipient: {\n                id: recipientId\n            },\n            message: {\n                \"text\": \"El producto \" + product.get('name') + \" ha sido agregado.\\n\\nDeseas agregar otro producto o terminar tu pedido?\",\n                \"quick_replies\": [{\n                    \"content_type\": \"text\",\n                    \"title\": \"Seguir pidiendo\",\n                    \"payload\": \"SendCategories-0\"\n                }, {\n                    \"content_type\": \"text\",\n                    \"title\": \"Ver carrito\",\n                    \"payload\": \"SendShoppingCart\"\n                }]\n            }\n        };\n        bot.sendTypingOff(recipientId);\n        bot.callSendAPI(messageData);\n    }, function (object, error) {\n        console.log(error);\n        // error is an instance of Parse.Error.\n    });\n}\n\nfunction sendPurchaseOptions(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Deseas agregar otro producto o terminar tu pedido?\",\n            \"quick_replies\": [{\n                \"content_type\": \"text\",\n                \"title\": \"Seguir pidiendo\",\n                \"payload\": \"SendCategories-0\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"Ver carrito\",\n                \"payload\": \"SendShoppingCart\"\n            }]\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction sendShoppingCart(recipientId) {\n    // Generate a random receipt ID as the API requires a unique ID\n    bot.sendTypingOn(recipientId);\n\n    var elements = [];\n    var element = {};\n    var total = 0;\n    var orderLimit = order.count();\n    var ind = 0;\n    var image;\n    var image_url;\n\n    console.log('Shopping Cart');\n\n    if (orderLimit == 0) {\n        renderShoppingCartEmpty(recipientId);\n    } else {\n        order.forEach(function (value, key) {\n            var Product = Parse.Object.extend(\"Product\");\n            var product = new Parse.Query(Product);\n            //console.log(key);\n\n            product.get(key, {\n                success: function success(item) {\n                    image = item.get('image');\n                    image_url = \"http://pro.parse.inoutdelivery.com/parse/files/hSMaiK7EXqDqRVYyY2fjIp4lBweiZnjpEmhH4LpJ/2671158f9c1cb43cac1423101b6e451b_image.txt\";\n                    if (image) {\n                        image_url = image.url();\n                    }\n\n                    element = {};\n                    element['title'] = item.get('name');\n                    element['subtitle'] = item.get('description');\n                    element['quantity'] = order.get(key);\n                    element['price'] = parseInt(item.get('priceDefault'));\n                    element['currency'] = \"COP\";\n                    element['image_url'] = image_url;\n\n                    elements.push(element);\n                    total += element['quantity'] * element['price'];\n\n                    ind++;\n\n                    if (ind == orderLimit) {\n                        renderShoppingCart(recipientId, elements, total);\n                    }\n                },\n                error: function error(_error3) {\n                    alert(\"Error: \" + _error3.code + \" \" + _error3.message);\n                }\n            });\n        });\n    }\n}\n\nfunction renderShoppingCartEmpty(recipientId) {\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Tu carrito de compras está vacío.\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData, sendPurchaseOptions);\n}\n\nfunction renderShoppingCart(recipientId, elements, total) {\n    var receiptId = \"order\" + Math.floor(Math.random() * 1000);\n\n    (0, _request2.default)({\n        uri: 'https://graph.facebook.com/v2.6/' + recipientId,\n        qs: { access_token: PAGE_ACCESS_TOKEN, fields: 'first_name,last_name,locale,timezone,gender' },\n        method: 'GET'\n\n    }, function (error, response, body) {\n        if (!error && response.statusCode == 200) {\n            var userData = JSON.parse(body);\n            //console.log(userData)\n\n            var messageData = {\n                recipient: {\n                    id: recipientId\n                },\n                message: {\n                    attachment: {\n                        type: \"template\",\n                        payload: {\n                            template_type: \"receipt\",\n                            recipient_name: userData.first_name + \" \" + userData.last_name,\n                            order_number: receiptId,\n                            currency: \"COP\",\n                            payment_method: \"Visa 1234\",\n                            timestamp: Math.trunc(Date.now() / 1000).toString(),\n                            elements: elements,\n                            address: {\n                                street_1: \"Carrera x con calle x\",\n                                street_2: \"\",\n                                city: \"Medellin\",\n                                postal_code: \"680001\",\n                                state: \"SA\",\n                                country: \"CO\"\n                            },\n                            summary: {\n                                subtotal: total,\n                                shipping_cost: 2000.00,\n                                total_tax: total * 0.16,\n                                total_cost: total * 1.16 + 2000.00\n                            }\n                            //adjustments: [{\n                            //  name: \"New Customer Discount\",\n                            //  amount: -1000\n                            //}, {\n                            //    name: \"$1000 Off Coupon\",\n                            //    amount: -1000\n                            //}]\n                        }\n                    }\n                }\n            };\n            //order = new HashMap();\n            //console.log(\"callSendAPI(messageData)\");\n            bot.sendTypingOff(recipientId);\n            bot.callSendAPI(messageData, renderShoppingCartConfirmation);\n            //bot.sendTypingOn(recipientId);\n        }\n    });\n}\n\nfunction renderShoppingCartConfirmation(recipientId) {\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Es correcto, deseas finalizar tu pedido?\",\n            \"quick_replies\": [{\n                \"content_type\": \"text\",\n                \"title\": \"Si\",\n                \"payload\": \"Checkout\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"No\",\n                \"payload\": \"SendPurchaseOptions\"\n            }]\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction checkout(recipientId) {\n    bot.sendTypingOn(recipientId);\n\n    renderCheckout(recipientId);\n}\n\nfunction renderCheckout(recipientId) {\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Como vas a pagar tu pedido? (Tu pedido se cobra cuando lo recibes)\",\n            \"quick_replies\": [{\n                \"content_type\": \"text\",\n                \"title\": \"Tarjeta Online\",\n                \"payload\": \"CreditCard\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"PSE\",\n                \"payload\": \"PSE\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"Efectivo\",\n                \"payload\": \"Cash\"\n            }]\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction checkCreditCard(recipientId) {\n    bot.sendTypingOn(recipientId);\n\n    renderCreditCard(recipientId);\n}\n\nfunction renderCreditCard(recipientId) {\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Aun no tienes tarjetas registradas, deseas registrar una tarjeta?\",\n            \"quick_replies\": [{\n                \"content_type\": \"text\",\n                \"title\": \"Si\",\n                \"payload\": \"RegisterCreditCard\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"No\",\n                \"payload\": \"Checkout\"\n            }]\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction registerCreditCard(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"attachment\": {\n                \"type\": \"template\",\n                \"payload\": {\n                    \"template_type\": \"button\",\n                    \"text\": \"Por razones de seguidad te vamos a redireccionar a una página web segura para que agregues tu tarjeta y finalizaremos tu pedido.\\n\\nEstas de acuerdo?\",\n                    \"buttons\": [{\n                        \"type\": \"web_url\",\n                        \"url\": \"https://bot.inoutdelivery.com/\",\n                        \"title\": \"Si\"\n                    }, {\n                        \"type\": \"postback\",\n                        \"title\": \"No\",\n                        \"payload\": \"CancelRegisterCreditCard\"\n                    }]\n                }\n            }\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData, confirmRegisterCreditCard);\n}\n\nfunction cancelRegisterCreditCard(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Si no ingresas los datos de tu tarjeta en nuestro sitio seguro, no podras comprar con tarjeta online\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData, checkout);\n}\n\nfunction confirmRegisterCreditCard(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Con cual tarjeta quieres pagar?\",\n            \"quick_replies\": [{\n                \"content_type\": \"text\",\n                \"title\": \"xxxx-xxxx-xxxx-9876\",\n                \"payload\": \"PayWithCreditCard-9876\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"Agregar tarjeta\",\n                \"payload\": \"RegisterCreditCard\"\n            }]\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction payWithCreditCard(recipientId, creditCardId) {\n    bot.sendTypingOn(recipientId);\n\n    orderConfirmation(recipientId);\n}\n\nfunction orderConfirmation(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Tu pedido ha sido registrado. \\n\\n En un momento te estaremos dando información en tiempo real sobre tu pedido\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData, orderState);\n}\n\nfunction orderState(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Tu pedido ha sido Aceptado. \\n\\n Lo estan preparando en nuestra sede y te lo enviaremos en aproximadamente 10 minutos\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData, orderSent);\n}\n\nfunction orderSent(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Buenas noticias, Tu pedido ha sido Enviado. \\n\\n Haz click en el mapa para vel tu pedido\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData, serviceRating);\n}\n\nfunction serviceRating(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Califica tu experiencia para ayudarnos a mejorar. \\n\\n De 1 a 5 cuantas extrellas merece nuestro servicio?\",\n            \"quick_replies\": [{\n                \"content_type\": \"text\",\n                \"title\": \"5 (Excelente)\",\n                \"payload\": \"SetRating-5\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"4 (Bien)\",\n                \"payload\": \"SetRating-4\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"3 (Regular)\",\n                \"payload\": \"SetRating-3\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"2 (Mal)\",\n                \"payload\": \"SetRating-2\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"2 (Muy mal)\",\n                \"payload\": \"SetRating-1\"\n            }]\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction setRating(recipientId, rating) {\n    bot.sendTypingOn(recipientId);\n\n    thank(recipientId);\n}\n\nfunction thank(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Gracias, esperamos tener el gusto de atenderle nuevamente\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nstore.dispatch({ type: types.APP_LOADED });\n\n/*\nconsole.log('Exist FB.init: '+( typeof FB.init === 'function') );\nconsole.log(FB.getLoginUrl({ scope: 'user_about_me' }));\n\n Parse.FacebookUtils.init({ // this line replaces FB.init({\n appId      : FACEBOOK_APP_ID, // Facebook App ID\n cookie     : true,  // enable cookies to allow Parse to access the session\n xfbml      : true,  // initialize Facebook social plugins on the page\n version    : 'v2.4' // point to the latest Facebook Graph API version\n });\n */\n\nvar order = new _hashmap2.default();"]}