{"version":3,"sources":["app.js"],"names":[],"mappings":"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","file":"app-compiled.js","sourcesContent":["'use strict';\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nvar _underscore = require('underscore');\n\nvar _ = _interopRequireWildcard(_underscore);\n\nvar _bot = require('./bot');\n\nvar bot = _interopRequireWildcard(_bot);\n\nvar _actionTypes = require('./constants/actionTypes');\n\nvar types = _interopRequireWildcard(_actionTypes);\n\nvar _index = require('./actions/index');\n\nvar Actions = _interopRequireWildcard(_index);\n\nvar _ParseModels = require('./models/ParseModels');\n\nvar ParseModels = _interopRequireWildcard(_ParseModels);\n\nvar _ParseUtils = require('./ParseUtils');\n\nvar _redux = require('redux');\n\nvar _utils = require('./utils');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _config = require('config');\n\nvar _config2 = _interopRequireDefault(_config);\n\nvar _request = require('request');\n\nvar _request2 = _interopRequireDefault(_request);\n\nvar _hashmap = require('hashmap');\n\nvar _hashmap2 = _interopRequireDefault(_hashmap);\n\nvar _objectAssign = require('object-assign');\n\nvar _objectAssign2 = _interopRequireDefault(_objectAssign);\n\nvar _reduxThunk = require('redux-thunk');\n\nvar _reduxThunk2 = _interopRequireDefault(_reduxThunk);\n\nvar _fb = require('fb');\n\nvar _fb2 = _interopRequireDefault(_fb);\n\nvar _geocoder = require('geocoder');\n\nvar _geocoder2 = _interopRequireDefault(_geocoder);\n\nvar _path = require('path');\n\nvar _path2 = _interopRequireDefault(_path);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nvar APP_SECRET = process.env.MESSENGER_APP_SECRET ? process.env.MESSENGER_APP_SECRET : _config2.default.get('APP_SECRET');\n\nvar PAGE_ACCESS_TOKEN = process.env.MESSENGER_PAGE_ACCESS_TOKEN ? process.env.MESSENGER_PAGE_ACCESS_TOKEN : _config2.default.get('PAGE_ACCESS_TOKEN');\n\nvar SERVER_URL = process.env.SERVER_URL ? process.env.SERVER_URL : _config2.default.get('SERVER_URL');\n\nvar PARSE_APP_ID = process.env.PARSE_APP_ID ? process.env.PARSE_APP_ID : _config2.default.get('PARSE_APP_ID');\n\nvar PARSE_SERVER_URL = process.env.PARSE_SERVER_URL ? process.env.PARSE_SERVER_URL : _config2.default.get('PARSE_SERVER_URL');\n\nvar PARSE_CLIENT_KEY = process.env.PARSE_CLIENT_KEY ? process.env.PARSE_CLIENT_KEY : _config2.default.get('PARSE_CLIENT_KEY');\n\nvar FACEBOOK_APP_ID = process.env.FACEBOOK_APP_ID ? process.env.FACEBOOK_APP_ID : _config2.default.get('FACEBOOK_APP_ID');\n\nvar REDIRECT_URI = process.env.REDIRECT_URI ? process.env.REDIRECT_URI : _config2.default.get('REDIRECT_URI');\n\nvar BUSINESS_ID = process.env.BUSINESS_ID ? process.env.BUSINESS_ID : _config2.default.get('BUSINESS_ID');\n\nvar GOOGLE_MAPS_URL = process.env.GOOGLE_MAPS_URL ? process.env.GOOGLE_MAPS_URL : _config2.default.get('GOOGLE_MAPS_URL');\n\nvar GOOGLE_MAPS_KEY = process.env.GOOGLE_MAPS_KEY ? process.env.GOOGLE_MAPS_KEY : _config2.default.get('GOOGLE_MAPS_KEY');\n\nvar FIREBASE_URL = process.env.FIREBASE_URL ? process.env.FIREBASE_URL : _config2.default.get('FIREBASE_URL');\n\n_fb2.default.options({\n    appId: FACEBOOK_APP_ID,\n    appSecret: APP_SECRET,\n    redirectUri: REDIRECT_URI\n});\n\nbot.rules.set('hola', sendMenu);\nbot.rules.set('iniciar', sendMenu);\nbot.rules.set('empezar', sendMenu);\nbot.rules.set('comenzar', sendMenu);\nbot.rules.set('buenos dias', sendMenu);\nbot.rules.set('buenas tardes', sendMenu);\nbot.rules.set('pedir domicilio', sendAddresses);\nbot.rules.set('carrito', sendCart);\nbot.rules.set('cuenta', sendCart);\n\nbot.payloadRules.set('Greeting', sendMenu);\n\nbot.payloadRules.set('SendAddresses', sendAddresses);\nbot.payloadRules.set('NewAddress', newAddress);\nbot.payloadRules.set('SetAddressComplement', setAddressComplement);\nbot.payloadRules.set('ConfirmAddress', confirmAddress);\nbot.payloadRules.set('SetAddress', setAddress);\n\nbot.payloadRules.set('SendCategories', sendCategories);\nbot.payloadRules.set('SendProducts', sendProducts);\nbot.payloadRules.set('AddProduct', addProduct);\nbot.payloadRules.set('RemoveProduct', removeProduct);\nbot.payloadRules.set('IncreaseOneProduct', increaseOneProduct);\nbot.payloadRules.set('DecreaseOneProduct', decreaseOneProduct);\n\nbot.payloadRules.set('Search', searchProducts);\nbot.payloadRules.set('SendCart', sendCart);\nbot.payloadRules.set('SendCartDetails', sendCartDetails);\nbot.payloadRules.set('EditCart', editCart);\nbot.payloadRules.set('ClearCart', clearCart);\nbot.payloadRules.set('SendPurchaseOptions', sendPurchaseOptions);\n\nbot.payloadRules.set('Checkout', checkout);\nbot.payloadRules.set('CheckPayment', checkPayment);\nbot.payloadRules.set('CheckAddress', checkAddress);\nbot.payloadRules.set('CheckOrder', checkOrder);\nbot.payloadRules.set('RegisterCreditCard', registerCreditCard);\nbot.payloadRules.set('SendRegisteredCreditCards', sendRegisteredCreditCards);\nbot.payloadRules.set('CancelRegisterCreditCard', cancelRegisterCreditCard);\nbot.payloadRules.set('PayWithCreditCard', payWithCreditCard);\nbot.payloadRules.set('SendOrders', sendOrders);\nbot.payloadRules.set('NewOrder', newOrder);\nbot.payloadRules.set('SetScore', setScore);\nbot.payloadRules.set('Help', sendHelp);\n\nbot.defaultSearch = searchProducts;\n\nvar initialState = {\n    userData: {},\n\n    geocodedLocation: { lat: -1, lng: -1 },\n    addresses: [],\n    mapBounds: {},\n    mapAddress: '',\n    useSubCategories: false,\n    products: [],\n    pointOfSales: [],\n    categories: [],\n    paymentMethods: [],\n    consumer: {},\n    customer: {},\n    orders: { ongoing: [], delivered: [] },\n    orderToRate: null,\n    currentOrder: {\n        consumerAddress: {},\n        items: []\n    },\n    locationZoom: 3,\n    profileIsOpen: false,\n    mapAddressIsOpen: false,\n    addressFormIsOpen: false,\n    addressListIsOpen: false,\n    savingAddress: false,\n    creatingOrder: false,\n    paymentMethodNotSelected: false,\n    cartTotalIsBelowMinimumPrice: false,\n    currentCategory: {},\n    consumerNotFound: false,\n    updatingConsumer: false,\n    currentUser: {},\n    pendingOrder: false\n};\n\nvar reducer = function reducer() {\n    var state = arguments.length <= 0 || arguments[0] === undefined ? initialState : arguments[0];\n    var action = arguments[1];\n\n    console.log('ACTION');\n    console.log(action);\n    var data = action.data;\n\n    if (data && data.hasOwnProperty('recipientId')) {\n        if (_typeof(state.userData[data.recipientId]) != 'object') {\n            state.userData[data.recipientId] = {};\n        }\n    }\n\n    switch (action.type) {\n        case types.APP_LOADED:\n            console.log('Application is running on port', bot.app.get('port'));\n            return _extends({}, state);\n\n        case types.CUSTOMER_LOADED:\n            var customer = (0, _ParseUtils.extractParseAttributes)(data.customer);\n\n            if (_typeof(state.userData[data.recipientId]) != 'object') {\n                state.userData[data.recipientId] = {};\n            }\n            (0, _objectAssign2.default)(state.userData[data.recipientId], { customer: customer });\n            return _extends({}, state);\n\n        case types.CONSUMER_LOADED:\n            //if (state.consumerNotFound) delete state.consumerNotFound;\n            var _consumer2 = (0, _ParseUtils.extractParseAttributes)(data.consumer);\n            (0, _objectAssign2.default)(state.userData[data.recipientId], { consumer: _consumer2 });\n            return _extends({}, state);\n\n        case types.USER_LOADED:\n            var _user2 = (0, _ParseUtils.extractParseAttributes)(data.user);\n            (0, _objectAssign2.default)(state.userData[data.recipientId], { user: _user2 });\n            return _extends({}, state);\n\n        case types.CONSUMER_ADDRESSES_LOADED:\n            var addresses = data.addresses.map(function (a) {\n                return (0, _ParseUtils.extractParseAttributes)(a);\n            });\n            (0, _objectAssign2.default)(state.userData[data.recipientId], { addresses: addresses });\n            return _extends({}, state);\n\n        case types.SET_CURRENT_ADDRESS:\n            var address = (0, _ParseUtils.extractParseAttributes)(data.address);\n            (0, _objectAssign2.default)(state.userData[data.recipientId], { address: address });\n            return _extends({}, state);\n\n        case types.PAYMENT_METHODS_LOADED:\n            console.log('PAYMENT_METHODS_LOADED');\n            console.log(data.paymentMethods);\n            var paymentMethods = data.paymentMethods.map(function (p) {\n                return (0, _ParseUtils.extractParseAttributes)(p);\n            });\n            (0, _objectAssign2.default)(state.userData[data.recipientId], { paymentMethods: paymentMethods });\n            return _extends({}, state);\n\n        case types.SET_PAYMENT_METHOD:\n            var paymentMethod = (0, _ParseUtils.extractParseAttributes)(data.paymentMethod);\n            (0, _objectAssign2.default)(state.userData[data.recipientId], { paymentMethod: paymentMethod });\n            return _extends({}, state);\n\n        case types.CONSUMER_UPDATED:\n            return _extends({}, state);\n\n        case types.CONSUMER_NOT_FOUND:\n            (0, _objectAssign2.default)(state, {\n                consumerNotFound: true,\n                currentUser: action.data.user\n            });\n            return _extends({}, state);\n\n        case types.CONSUMER_ORDERS_LOADED:\n            var orders = data.orders.map(function (a) {\n                return (0, _ParseUtils.extractParseAttributes)(a);\n            });\n            (0, _objectAssign2.default)(state.userData[data.recipientId], { orders: orders });\n            return _extends({}, state);\n            /*let ongoing = orders['ongoing'].map(o => extractParseAttributes(o))\n            let delivered = orders['delivered'].map(o => extractParseAttributes(o))\n            let orderToRate = delivered[0]\n            objectAssign(state, {\n                orders: {ongoing, delivered},\n                orderToRate\n            })*/\n            return _extends({}, state);\n\n        case types.USER_CREDITCARDS_LOADED:\n            var creditCards = data.creditCards.map(function (a) {\n                return (0, _ParseUtils.extractParseAttributes)(a);\n            });\n            (0, _objectAssign2.default)(state.userData[data.recipientId], { creditCards: creditCards });\n            return _extends({}, state);\n\n        case types.SET_CUSTOMER_POINT_SALE:\n            var pointSale = (0, _ParseUtils.extractParseAttributes)(data.pointSale);\n            (0, _objectAssign2.default)(state.userData[data.recipientId], { pointSale: pointSale });\n            return _extends({}, state);\n\n        case types.SET_ORDER:\n            var order = (0, _ParseUtils.extractParseAttributes)(data.order);\n            (0, _objectAssign2.default)(state.userData[data.recipientId], { order: order });\n            return _extends({}, state);\n\n        case types.SET_USER:\n            var _user2 = (0, _ParseUtils.extractParseAttributes)(data.user);\n            (0, _objectAssign2.default)(state.userData[data.recipientId], { user: _user2 });\n            return _extends({}, state);\n\n        case types.SET_CONSUMER:\n            var _consumer2 = (0, _ParseUtils.extractParseAttributes)(data.consumer);\n            (0, _objectAssign2.default)(state.userData[data.recipientId], { consumer: _consumer2 });\n            return _extends({}, state);\n\n        case types.SET_ORDER_STATE:\n            var _orderState = (0, _ParseUtils.extractParseAttributes)(data.orderState);\n            (0, _objectAssign2.default)(state.userData[data.recipientId], { orderState: _orderState });\n            return _extends({}, state);\n\n        case types.RENDER_MENU:\n            /*\n            console.log('Store');\n            console.log('Consumer');\n            console.log(consumer);*/\n            renderMenu();\n\n            /*request({\n             uri: 'https://graph.facebook.com/v2.6/' + '1100195690052041',\n             qs: {access_token: PAGE_ACCESS_TOKEN, fields: 'first_name,last_name,locale,timezone,gender'},\n             method: 'GET'\n             }, renderMenuMessage);*/\n            return state;\n\n        case types.RENDER_ADDRESS_MENU:\n            renderAddress();\n            return state;\n\n        default:\n            return state;\n    }\n};\n\nvar store = (0, _redux.createStore)(reducer, (0, _redux.applyMiddleware)(_reduxThunk2.default));\n\nstore.subscribe(function () {\n    return console.log('\\n');\n});\n\n//global.FB = FB;\n\nfunction getData(recipientId, property) {\n    if (recipientId !== undefined) {\n        var data = store.getState().userData;\n        var userData = data[recipientId];\n\n        if (userData == undefined) {\n            data[recipientId] = {};\n            userData = data[recipientId];\n        }\n\n        if (property == undefined) return userData;else {\n            if (userData.hasOwnProperty(property)) {\n                return userData[property];\n            } else return undefined;\n        }\n    }\n}\n\nfunction login(username, password) {\n    return Parse.User.logIn(username, password, {\n        success: function success(user) {\n            /*console.log(Parse.User.current());\n             console.log(user);\n             console.log(user.authenticated());\n             console.log(user.getSessionToken());*/\n            var val = JSON.stringify({ sessionToken: user.getSessionToken() });\n            //console.log(val);\n\n            /*Parse.User.become(_user.getSessionToken()).then(__user => {\n             console.log(Parse.User.current());\n             console.log(__user);\n             console.log(__user.authenticated());\n             console.log(__user.getSessionToken());\n             });\n              _;*/\n        },\n        error: function error(user, _error) {\n            // An error occurred.\n        } });\n}\n\nfunction authentication(recipientId, callback) {\n    var user = getData(recipientId, 'user');\n    var consumer = getData(recipientId, 'consumer');\n    var username = recipientId.toString();\n\n    if (typeof user == 'undefined') {\n        user = new ParseModels.User({ recipientId: recipientId });\n    } else {\n        user = user.rawParseObject;\n    }\n\n    user.registered().then(function (_user) {\n        if (typeof _user == 'undefined') {\n            bot.getFacebookUser(recipientId).then(function (data) {\n                user.signUpWithFacebook(data).then(function () {\n                    username = user.get('username');\n                    login(username, username).then(function () {\n                        user.saveInStore(store).then(function () {\n                            if (typeof consumer == 'undefined') {\n                                createConsumer(user).then(function (_consumer) {\n                                    _consumer.saveInStore(store).then(function () {\n                                        if (callback) {\n                                            callback(user);\n                                        }\n                                    });\n                                });\n                            } else {\n                                if (callback) {\n                                    callback(user);\n                                }\n                            }\n                        });\n                    });\n                });\n            });\n        } else {\n            username = _user.get('username');\n            login(username, username).then(function () {\n                _user.saveInStore(store).then(function () {\n                    if (typeof consumer == 'undefined') {\n                        createConsumer(user).then(function (_consumer) {\n                            _consumer.saveInStore(store).then(function () {\n                                if (callback) {\n                                    callback(user);\n                                }\n                            });\n                        });\n                    } else {\n                        if (callback) {\n                            callback(user);\n                        }\n                    }\n                });\n            });\n        }\n    });\n}\n\nfunction createConsumer(user) {\n    var consumer = new ParseModels.Consumer();\n    consumer.setUser(user);\n    return consumer.save().fail(function (error) {\n        console.log('Error code: ' + error.message);\n    });\n}\n\nfunction loadUser(recipientId) {\n    return store.dispatch(Actions.loadUser(recipientId));\n}\n\nfunction loadCustomer(recipientId) {\n    return store.dispatch(Actions.loadCustomer(recipientId, BUSINESS_ID));\n}\n\nfunction loadConsumer(recipientId, user) {\n    return store.dispatch(Actions.loadConsumer(recipientId, user.rawParseObject));\n}\n\nfunction loadConsumerAddresses(recipientId, consumer) {\n    return store.dispatch(Actions.loadConsumerAddresses(recipientId, consumer.rawParseObject));\n}\n\nfunction sendMenu(recipientId) {\n    bot.sendTypingOn(recipientId);\n\n    authentication(recipientId, function () {\n        var user = getData(recipientId, 'user');\n\n        loadCustomer(recipientId).then(function () {\n            loadConsumer(recipientId, user).then(function () {\n                renderMenu(recipientId);\n            });\n        });\n    });\n}\n\nfunction renderMenu(recipientId) {\n    var customer = getData(recipientId, 'customer');\n    var consumer = getData(recipientId, 'consumer');\n\n    var image_url = customer.image.url;\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            attachment: {\n                type: \"template\",\n                payload: {\n                    template_type: \"generic\",\n                    //text: \"Buenos dias, para conocer nuestros menus del dia, por favor escoja una opción:\",\n                    elements: [{\n                        \"title\": \"Hola \" + consumer.name + \", Bienvenido a \" + customer.name,\n                        \"subtitle\": \"Aquí puedes pedir un domicilio, escribe o selecciona alguna de las opciones:\",\n                        \"image_url\": image_url,\n                        \"buttons\": [{\n                            \"type\": \"postback\",\n                            \"title\": \"Pedir domicilio\",\n                            \"payload\": \"SendAddresses\"\n                        }, {\n                            \"type\": \"postback\",\n                            \"title\": \"Pedir para recoger\",\n                            \"payload\": \"TakeOut\"\n                        }, {\n                            \"type\": \"postback\",\n                            \"title\": \"Servicio al cliente\",\n                            \"payload\": \"CustomerService\"\n                        }]\n                    }]\n                }\n            }\n        }\n    };\n\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction sendAddresses(recipientId) {\n    bot.sendTypingOn(recipientId);\n\n    authentication(recipientId, function () {\n        var user = getData(recipientId, 'user');\n        var consumer = getData(recipientId, 'consumer');\n\n        loadCustomer(recipientId).then(function () {\n            loadConsumer(recipientId, user).then(function () {\n                loadConsumerAddresses(recipientId, consumer).then(function () {\n                    renderAddress(recipientId);\n                });\n            });\n        });\n    });\n}\n\nfunction renderAddress(recipientId) {\n\n    var addresses = getData(recipientId, 'addresses');\n    var elements = [];\n\n    //\"title\": \"A cual dirección vas hacer tu pedido?\",\n    //\"subtitle\": \"Puedes escoger entre tus direcciones guardadas o agregar una nueva dirección\",\n    renderAddressTitle(recipientId, function () {\n        elements.push({\n            \"title\": \"Nueva dirección\",\n            \"subtitle\": \"Puedes agregar una nueva dirección\",\n            \"image_url\": SERVER_URL + \"assets/new_address_blue.jpg\",\n            \"buttons\": [{\n                \"type\": \"postback\",\n                \"title\": \"Nueva dirección\",\n                \"payload\": \"NewAddress\"\n            }]\n        });\n\n        var _iteratorNormalCompletion = true;\n        var _didIteratorError = false;\n        var _iteratorError = undefined;\n\n        try {\n            for (var _iterator = addresses[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                var address = _step.value;\n\n                if (elements.length < bot.limit) {\n                    elements.push({\n                        \"title\": address.name.capitalizeFirstLetter(),\n                        \"subtitle\": address.address + \", \" + address.description + \", \" + address.city + \", \" + address.state,\n                        \"image_url\": GOOGLE_MAPS_URL + \"?center=\" + address.location.lat + \",\" + address.location.lng + \"&zoom=16&size=400x400&markers=color:red%7C\" + address.location.lat + \",\" + address.location.lng + \"&key=\" + GOOGLE_MAPS_KEY,\n                        \"buttons\": [{\n                            \"type\": \"postback\",\n                            \"title\": address.name.capitalizeFirstLetter(),\n                            \"payload\": \"SetAddress-\" + address.objectId\n                        }]\n                    });\n                }\n            }\n        } catch (err) {\n            _didIteratorError = true;\n            _iteratorError = err;\n        } finally {\n            try {\n                if (!_iteratorNormalCompletion && _iterator.return) {\n                    _iterator.return();\n                }\n            } finally {\n                if (_didIteratorError) {\n                    throw _iteratorError;\n                }\n            }\n        }\n\n        var messageData = {\n            recipient: {\n                id: recipientId\n            },\n            message: {\n                \"attachment\": {\n                    \"type\": \"template\",\n                    \"payload\": {\n                        \"template_type\": \"generic\",\n                        \"elements\": elements\n                    }\n                }\n            }\n        };\n\n        bot.sendTypingOff(recipientId);\n        bot.callSendAPI(messageData);\n    });\n}\n\nfunction renderAddressTitle(recipientId, callback) {\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"A cual dirección vas hacer tu pedido?\\n\\nPuedes escoger entre agregar una nueva dirección o seleccionar una de tus direcciones guardadas\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData, callback);\n}\n\nfunction newAddress(recipientId) {\n    bot.sendTypingOff(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Puedes escribir o compartir tu ubicación actual?\\n\\nEjemplo: Calle 67 #52-20, Medellín\",\n            \"quick_replies\": [{\n                \"content_type\": \"location\"\n            }]\n        }\n    };\n\n    bot.setListener(recipientId, 'address', 'text', addressCheck);\n    bot.setListener(recipientId, 'location', 'attachment', setLocationCheck);\n\n    bot.callSendAPI(messageData);\n}\n\nfunction setAddressComplement(recipientId) {\n    bot.sendTypingOff(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Por favor escribe el complemento de tu dirección actual. \\n\\nEjemplo: Oficina 1068\"\n        }\n    };\n    bot.setListener(recipientId, 'complement', 'text', confirmAddress);\n    bot.callSendAPI(messageData);\n}\n\nfunction renderMapMessage(recipientId, callback) {\n    var userBuffer = bot.buffer[recipientId];\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        \"message\": {\n            \"text\": \"Encontré esta dirección en Google Maps:\\n\\n\" + userBuffer.address + \"\"\n        }\n    };\n\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData, callback);\n}\n\nfunction renderMap(recipientId, callback) {\n    bot.sendTypingOff(recipientId);\n    var userBuffer = bot.buffer[recipientId];\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        \"message\": {\n            \"attachment\": {\n                \"type\": \"image\",\n                \"payload\": {\n                    \"url\": GOOGLE_MAPS_URL + \"?center=\" + userBuffer.location.lat + \",\" + userBuffer.location.lng + \"&zoom=16&size=400x400&markers=color:red%7C\" + userBuffer.location.lat + \",\" + userBuffer.location.lng + \"&key=\" + GOOGLE_MAPS_KEY\n                }\n            }\n        }\n    };\n\n    bot.callSendAPI(messageData, callback);\n}\n\nfunction addressCheck(recipientId) {\n    var userBuffer = bot.buffer[recipientId];\n\n    _geocoder2.default.geocode(userBuffer.address, function (error, data) {\n        if (!error && data.status == 'OK') {\n            var result = data.results[0];\n\n            userBuffer.address = result.formatted_address;\n            userBuffer.location = result.geometry.location;\n\n            var _iteratorNormalCompletion2 = true;\n            var _didIteratorError2 = false;\n            var _iteratorError2 = undefined;\n\n            try {\n                for (var _iterator2 = result.address_components[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                    var component = _step2.value;\n\n                    if (component.types.includes('route')) {\n                        userBuffer.route = component.long_name;\n                    } else if (component.types.includes('street_number')) {\n                        userBuffer.street_number = component.short_name;\n                    } else if (component.types.includes('locality')) {\n                        userBuffer.locality = component.short_name;\n                    } else if (component.types.includes('administrative_area_level_1')) {\n                        userBuffer.state = component.short_name;\n                    } else if (component.types.includes('administrative_area_level_2')) {\n                        userBuffer.administrative_area = component.short_name;\n                    } else if (component.types.includes('country')) {\n                        userBuffer.country = component.long_name;\n                        userBuffer.country_code = component.short_name;\n                    } else if (component.types.includes('postal_code')) {\n                        userBuffer.postal_code = component.short_name;\n                    }\n                }\n            } catch (err) {\n                _didIteratorError2 = true;\n                _iteratorError2 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                        _iterator2.return();\n                    }\n                } finally {\n                    if (_didIteratorError2) {\n                        throw _iteratorError2;\n                    }\n                }\n            }\n\n            renderMapMessage(recipientId, function () {\n                renderMap(recipientId, function () {\n                    var messageData = {\n                        recipient: {\n                            id: recipientId\n                        },\n                        message: {\n                            \"text\": \"Es correcta?\",\n                            \"quick_replies\": [{\n                                \"content_type\": \"text\",\n                                \"title\": \"Si\",\n                                \"payload\": \"SetAddressComplement\"\n                            }, {\n                                \"content_type\": \"text\",\n                                \"title\": \"No\",\n                                \"payload\": \"NewAddress\"\n                            }]\n                        }\n                    };\n                    bot.sendTypingOff(recipientId);\n                    bot.callSendAPI(messageData);\n                });\n            });\n        } else {\n            console.log('Geocode not found');\n            console.log(error);\n        }\n    });\n}\n\nfunction writeAddressComplete(recipientId) {\n    var consumer = getData(recipientId, 'consumer');\n    var userBuffer = bot.buffer[recipientId];\n\n    console.log(userBuffer);\n\n    var location = new Parse.GeoPoint({ latitude: parseFloat(userBuffer.location.lat), longitude: parseFloat(userBuffer.location.lng) });\n\n    var consumerAddress = new ParseModels.ConsumerAddress();\n    consumerAddress.set('name', userBuffer['address-name']);\n    consumerAddress.set('address', userBuffer.route + \" # \" + userBuffer.street_number);\n    consumerAddress.set('consumer', {\n        __type: \"Pointer\",\n        className: \"Consumer\",\n        objectId: consumer.objectId\n    });\n    consumerAddress.set('location', location);\n    consumerAddress.set('city', userBuffer.locality);\n    consumerAddress.set('country', userBuffer.country);\n    consumerAddress.set('countryCode', userBuffer.country_code);\n    consumerAddress.set('postalCode', userBuffer.postal_code);\n    consumerAddress.set('state', userBuffer.state);\n    consumerAddress.set('description', userBuffer.complement);\n\n    consumerAddress.save(undefined, {\n        success: function success(result) {\n\n            delete userBuffer.address;\n            delete userBuffer.location;\n            delete userBuffer.complement;\n            delete userBuffer['address-name'];\n\n            var messageData = {\n                recipient: {\n                    id: recipientId\n                },\n                message: {\n                    \"text\": \"La dirección ha sido almacenada.\"\n                }\n            };\n\n            bot.sendTypingOff(recipientId);\n            bot.callSendAPI(messageData, function () {\n                setAddress(recipientId, result.id);\n            });\n        },\n        error: function error(user, _error2) {\n            // Execute any logic that should take place if the save fails.\n            // error is a Parse.Error with an error code and message.\n            console.log('Failed to create new object, with error code: ' + _error2.message);\n        }\n    });\n}\n\nfunction confirmAddress(recipientId) {\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Por favor coloca un nombre a esta dirección para guardarla. \\n\\nEjemplo: casa, apartamento o oficina\"\n        }\n    };\n    bot.setListener(recipientId, 'address-name', 'text', writeAddressComplete);\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction setEmail(recipientId) {\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Por favor escribe tu email:\"\n        }\n    };\n    bot.setListener(recipientId, 'email', 'text', setEmailCheck);\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction setEmailCheck(recipientId) {}\n\nfunction setTelephone(recipientId) {\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Por favor escribe tu número telefónico:\"\n        }\n    };\n    bot.setListener(recipientId, 'telephone', 'text', setTelephoneCheck);\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction setTelephoneCheck(recipientId) {}\n\nfunction setLocationCheck(recipientId) {\n    var userBuffer = bot.buffer[recipientId];\n\n    _geocoder2.default.reverseGeocode(userBuffer.location.lat, userBuffer.location.lng, function (error, data) {\n        if (!error && data.status == 'OK') {\n            var result = data.results[0];\n\n            userBuffer.address = result.formatted_address;\n            userBuffer.location = result.geometry.location;\n\n            var _iteratorNormalCompletion3 = true;\n            var _didIteratorError3 = false;\n            var _iteratorError3 = undefined;\n\n            try {\n                for (var _iterator3 = result.address_components[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n                    var component = _step3.value;\n\n                    //console.log(component);\n                    if (component.types.includes('locality')) {\n                        userBuffer.locality = component.short_name;\n                    } else if (component.types.includes('administrative_area_level_1')) {\n                        userBuffer.state = component.short_name;\n                    } else if (component.types.includes('administrative_area_level_2')) {\n                        userBuffer.administrative_area = component.short_name;\n                    } else if (component.types.includes('country')) {\n                        userBuffer.country = component.short_name;\n                    } else if (component.types.includes('postal_code')) {\n                        userBuffer.postal_code = component.short_name;\n                    }\n                }\n            } catch (err) {\n                _didIteratorError3 = true;\n                _iteratorError3 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion3 && _iterator3.return) {\n                        _iterator3.return();\n                    }\n                } finally {\n                    if (_didIteratorError3) {\n                        throw _iteratorError3;\n                    }\n                }\n            }\n\n            renderMapMessage(recipientId, function () {\n                renderMap(recipientId, function () {\n                    var messageData = {\n                        recipient: {\n                            id: recipientId\n                        },\n                        message: {\n                            \"text\": \"Es correcta?\",\n                            \"quick_replies\": [{\n                                \"content_type\": \"text\",\n                                \"title\": \"Si\",\n                                \"payload\": \"ConfirmAddress\"\n                            }, {\n                                \"content_type\": \"text\",\n                                \"title\": \"No\",\n                                \"payload\": \"newAddress\"\n                            }]\n                        }\n                    };\n                    bot.sendTypingOff(recipientId);\n                    bot.callSendAPI(messageData);\n                });\n            });\n        } else {\n            console.log('Geocode not found');\n        }\n    });\n}\n\nfunction setAddress(recipientId, id) {\n    bot.sendTypingOn(recipientId);\n\n    store.dispatch(Actions.setAddress(recipientId, id)).then(function () {\n        var address = getData(recipientId, 'address');\n\n        Parse.Cloud.run('getProducts', { businessId: BUSINESS_ID, lat: address.location.lat, lng: address.location.lng }).then(function (result) {\n            var pointSale = result.pointSale;\n\n            store.dispatch(Actions.setCustomerPointSale(recipientId, pointSale.id)).then(function () {\n                renderAddressConfirmation(recipientId);\n            });\n        }, function (error) {\n            if (error.code == '141') {\n                renderAddressOutOfCoverage(recipientId);\n            } else {\n                console.log('error');\n                console.log(error);\n            }\n        });\n        /*\n        Parse.Cloud.run('getProducts', { businessId: BUSINESS_ID }).then(\n            function(result){\n                var pointSale = result.pointSale\n                console.log('\\nPoint Sale');\n                console.log(pointSale);\n                 Parse.Cloud.run('isInsideCoverage', {lat: address.location.lat, lng: address.location.lng, pointSale: pointSale.id } ).then(\n                    function(result){\n                        console.log(result);\n                    },\n                    function(error) {\n                        console.log('error');\n                        console.log(error);\n                    });\n            },\n            function(error) {\n                console.log('error');\n                console.log(error);\n            });\n            */\n    });\n}\n\nfunction renderAddressOutOfCoverage(recipientId) {\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"La dirección seleccionada no está dentro de la cobertura de nuestras sedes, por favor intenta con otra dirección\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData, sendAddresses);\n}\n\nfunction renderAddressConfirmation(recipientId) {\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Perfecto, ya seleccioné tu dirección para este pedido\" //Perfecto, ya guardé tu dirección para próximos pedidos\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData, sendCategories);\n}\n\nfunction renderCategoriesInitialMessage(recipientId) {\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"A continuación te presentamos las categorías de productos disponibles.\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction sendCategories(recipientId, index) {\n    bot.sendTypingOn(recipientId);\n\n    if (index == undefined) index = 0;else if (typeof index == 'string') index = parseInt(index);\n\n    if (index == 0) {\n        renderCategoriesInitialMessage(recipientId);\n        bot.sendTypingOn(recipientId);\n    }\n\n    Parse.Cloud.run('getProducts', { businessId: BUSINESS_ID }).then(function (result) {\n        var elements = splitCategories(recipientId, result.categories, index);\n        var idx = Object.keys(result.categories).length;\n        var buttons = [];\n        var catIni = (index + 1) * bot.limit;\n        var catFin = idx > catIni + bot.limit ? catIni + bot.limit : idx;\n        /*\n        console.log('length: '+idx);\n        console.log('catIni: '+catIni);\n        console.log('catFin: '+catFin);\n        console.log('limitsearchProducts: '+(index+1)*bot.limit);\n        */\n        if (idx > (index + 1) * bot.limit) {\n            buttons.push({\n                type: \"postback\",\n                title: \"Categorías \" + (catIni + 1) + \"-\" + catFin,\n                payload: \"SendCategories-\" + (index + 1)\n            });\n\n            elements.push({\n                title: \"Ver más categorias \",\n                subtitle: \"Categorías disponibles\",\n                buttons: buttons\n            });\n        }\n\n        var messageData = {\n            recipient: {\n                id: recipientId\n            },\n            message: {\n                attachment: {\n                    type: \"template\",\n                    payload: {\n                        template_type: \"generic\",\n                        elements: elements\n                    }\n                }\n            }\n        };\n\n        bot.sendTypingOff(recipientId);\n        bot.callSendAPI(messageData);\n    }, function (error) {\n        console.log('error');\n        console.log(error);\n    });\n}\n\nfunction splitCategories(recipientId, categories, index) {\n    var customer = getData(recipientId, 'customer');\n    var image_url = customer.image.url;\n\n    var idx = 0;\n    var elements = [];\n\n    categories.forEach(function (item) {\n        if (item && item.get('name')) {\n            if (idx >= index * bot.limit && idx < (index + 1) * bot.limit) {\n                var image = item.get('image');\n                if (image) {\n                    image_url = image.url();\n                }\n                elements.push({\n                    title: item.get('name'),\n                    //subtitle: item.get('name'),\n                    //item_url: \"http://www.mycolombianrecipes.com/fruit-cocktail-salpicon-de-frutas\",\n                    image_url: image_url,\n                    buttons: [{\n                        type: \"postback\",\n                        title: item.get('name'),\n                        payload: \"SendProducts-\" + item.id + \"-\" + index\n                    }]\n                });\n            }\n            idx = idx + 1;\n        }\n    });\n    return elements;\n}\n\nfunction renderProductsInitialMessage(recipientId, categoryId) {\n    return new Parse.Query(ParseModels.Category).get(categoryId).then(function (category) {\n        var messageData = {\n            recipient: {\n                id: recipientId\n            },\n            message: {\n                text: category.get('name') + \":\"\n            }\n        };\n        bot.sendTypingOff(recipientId);\n        bot.callSendAPI(messageData);\n    }, function (object, error) {\n        console.log(error);\n        // error is an instance of Parse.Error.\n    });\n}\n\nfunction sendProducts(recipientId, category, proIdx) {\n    bot.sendTypingOn(recipientId);\n    proIdx = parseInt(proIdx);\n    if (proIdx == 0) {\n        renderProductsInitialMessage(recipientId, category);\n        bot.sendTypingOn(recipientId);\n    }\n\n    Parse.Cloud.run('getProducts', { businessId: BUSINESS_ID, category: category }).then(function (result) {\n        var elements = splitProducts(recipientId, result.products, proIdx);\n        var idx = Object.keys(result.products).length;\n        var buttons = [];\n        var catIni = (proIdx + 1) * bot.limit;\n        var catFin = idx > catIni + bot.limit ? catIni + bot.limit : idx;\n        /*\n        console.log('length: '+idx);\n        console.log('catIni: '+catIni);\n        console.log('catFin: '+catFin);\n        console.log('limit: '+(proIdx+1)*bot.limit);\n        */\n        if (idx > (proIdx + 1) * bot.limit) {\n            buttons.push({\n                type: \"postback\",\n                title: \"Productos \" + (catIni + 1) + \"-\" + catFin,\n                payload: \"SendProducts-\" + category + \"-\" + (proIdx + 1)\n            });\n\n            elements.push({\n                title: \"Ver más productos \",\n                subtitle: \"Productos disponibles\",\n                buttons: buttons\n            });\n        }\n\n        var messageData = {\n            recipient: {\n                id: recipientId\n            },\n            message: {\n                attachment: {\n                    type: \"template\",\n                    payload: {\n                        template_type: \"generic\",\n                        elements: elements\n                    }\n                }\n            }\n        };\n\n        bot.sendTypingOff(recipientId);\n        bot.callSendAPI(messageData);\n    }, function (error) {\n        console.log('error');\n        console.log(error);\n    });\n}\n\nfunction splitProducts(recipientId, products, proIdx) {\n    var customer = getData(recipientId, 'customer');\n    var image_url = customer.image.url;\n\n    if (typeof customer != 'undefined') {\n        image_url = customer.image.url;\n    }\n\n    var idx = 0;\n    var elements = [];\n\n    products.forEach(function (item) {\n        if (item && item.get('name')) {\n            if (idx >= proIdx * bot.limit && idx < (proIdx + 1) * bot.limit) {\n                var image = item.get('image');\n                if (image) {\n                    image_url = image.url();\n                }\n                elements.push({\n                    title: item.get('name') + \": $\" + item.get('priceDefault'),\n                    subtitle: item.get('description'),\n                    //item_url: \"http://www.mycolombianrecipes.com/fruit-cocktail-salpicon-de-frutas\",\n                    image_url: image_url,\n                    buttons: [{\n                        type: \"postback\",\n                        title: \"Agregar\",\n                        payload: \"AddProduct-\" + item.id\n                    }]\n                });\n            }\n            idx = idx + 1;\n        }\n    });\n    return elements;\n}\n\nfunction createCart(recipientId) {\n    var userData = getData(recipientId);\n    Object.assign(userData, { 'cart': { items: new Map() } });\n    return userData.cart;\n}\n\nfunction createOrder(recipientId) {\n    var userData = getData(recipientId);\n    Object.assign(userData, { 'order': new Map() });\n    return getData(recipientId, 'order');\n}\n\nfunction addProduct(recipientId, productId) {\n    //console.log(\"Add product: \"+productId);\n    //console.log(\"Order.count: \"+order.count());\n    var product = new ParseModels.Product();\n    var cart = getData(recipientId, 'cart');\n\n    if (cart == undefined) {\n        cart = createCart(recipientId);\n    }\n\n    var items = cart.items;\n\n    new Parse.Query(product).get(productId).then(function (product) {\n        if (!items.get(productId)) {\n            items.set(productId, { quantity: 1, price: product.get('priceDefault') });\n        } else {\n            items.get(productId).quantity += 1;\n        }\n\n        saveCart(recipientId);\n\n        renderAddProductConfirmation(recipientId, productId);\n    }, function (object, error) {\n        console.log(error);\n        // error is an instance of Parse.Error.\n    });\n}\n\nfunction removeProduct(recipientId, productId) {\n    var cart = getData(recipientId, 'cart');\n    console.log('Remove product ' + productId);\n    if (cart == undefined) {\n        cart = createCart(recipientId);\n    }\n\n    var items = cart.items;\n    var item = items.get(productId);\n\n    new Parse.Query(ParseModels.OrderItem).get(item.id, {\n        success: function success(orderItem) {\n            orderItem.destroy({});\n            items.delete(productId);\n            var itemsPointers = [];\n\n            var _iteratorNormalCompletion4 = true;\n            var _didIteratorError4 = false;\n            var _iteratorError4 = undefined;\n\n            try {\n                for (var _iterator4 = items[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n                    var _step4$value = _slicedToArray(_step4.value, 2);\n\n                    var key = _step4$value[0];\n                    var value = _step4$value[1];\n\n                    itemsPointers.push({ \"__type\": \"Pointer\", \"className\": \"OrderItem\", \"objectId\": value.id });\n                }\n            } catch (err) {\n                _didIteratorError4 = true;\n                _iteratorError4 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion4 && _iterator4.return) {\n                        _iterator4.return();\n                    }\n                } finally {\n                    if (_didIteratorError4) {\n                        throw _iteratorError4;\n                    }\n                }\n            }\n\n            cart.itemsPointers = itemsPointers;\n            if (items.size == 0) {\n                sendCart(recipientId);\n            } else {\n                sendCartDetails(recipientId);\n            }\n        },\n        error: function error(orderItem, _error3) {\n            console.log('error');\n            console.log(_error3);\n        }\n    });\n}\n\nfunction increaseOneProduct(recipientId, productId) {\n    var cart = getData(recipientId, 'cart');\n\n    if (cart == undefined) {\n        cart = createCart(recipientId);\n    }\n\n    var items = cart.items;\n    var item = items.get(productId);\n\n    item.quantity++;\n\n    new Parse.Query(ParseModels.OrderItem).get(item.id, {\n        success: function success(orderItem) {\n            orderItem.set('amount', item.quantity);\n            orderItem.save();\n            sendCartDetails(recipientId);\n        },\n        error: function error(orderItem, _error4) {\n            console.log('error');\n            console.log(_error4);\n        }\n    });\n}\n\nfunction decreaseOneProduct(recipientId, productId) {\n    var cart = getData(recipientId, 'cart');\n\n    if (cart == undefined) {\n        cart = createCart(recipientId);\n    }\n\n    var items = cart.items;\n    var item = items.get(productId);\n\n    item.quantity--;\n    console.log('Order Item');\n    console.log(item);\n\n    if (item.quantity > 0) {\n        new Parse.Query(ParseModels.OrderItem).get(item.id, {\n            success: function success(orderItem) {\n                orderItem.set('amount', item.quantity);\n                orderItem.save();\n                sendCartDetails(recipientId);\n            },\n            error: function error(orderItem, _error5) {\n                console.log('error');\n                console.log(_error5);\n            }\n        });\n    } else {\n        console.log('remove');\n        console.log(item);\n        removeProduct(recipientId, productId);\n    }\n}\n\nfunction saveCart(recipientId) {\n    var consumerCart = new ParseModels.Cart();\n    var consumer = getData(recipientId, 'consumer');\n    var address = getData(recipientId, 'address');\n    var cart = getData(recipientId, 'cart');\n    var paymentMethod = getData(recipientId, 'paymentMethod');\n    var items = [];\n    var item;\n\n    var _iteratorNormalCompletion5 = true;\n    var _didIteratorError5 = false;\n    var _iteratorError5 = undefined;\n\n    try {\n        for (var _iterator5 = cart.items[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n            var _step5$value = _slicedToArray(_step5.value, 2);\n\n            var id = _step5$value[0];\n            var properties = _step5$value[1];\n\n            //console.log('\\n'+id);\n            //console.log(properties);\n\n            item = new ParseModels.OrderItem();\n\n            if (properties.hasOwnProperty('id')) {\n                item.set('id', properties.id);\n            }\n\n            item.set('product', {\n                __type: \"Pointer\",\n                className: \"Product\",\n                objectId: id\n            });\n            item.set('price', properties.price);\n            item.set('amount', properties.quantity);\n            item.set('modifiersGroups', []);\n            items.push(item);\n\n            /*\n            item.save(undefined, {\n                success: function(result) {\n                    //console.log('\\nItem save');\n                    //console.log(result);\n                    //console.log(result.get('product'));\n                    var itemId = result.get('product').objectId;\n                    //console.log(cart.items.get(itemId));\n                    cart.items.get(itemId).id = result.id;\n                    //console.log(cart.items.get(itemId));\n                },\n                error: function(user, error) {\n                    // Execute any logic that should take place if the save fails.\n                    // error is a Parse.Error with an error code and message.\n                    console.log('Failed to create new object, with error code: ' + error.message);\n                }\n            });\n            */\n        }\n    } catch (err) {\n        _didIteratorError5 = true;\n        _iteratorError5 = err;\n    } finally {\n        try {\n            if (!_iteratorNormalCompletion5 && _iterator5.return) {\n                _iterator5.return();\n            }\n        } finally {\n            if (_didIteratorError5) {\n                throw _iteratorError5;\n            }\n        }\n    }\n\n    Parse.Object.saveAll(items, {\n        success: function success(result) {\n            var itemsPointers = [];\n            var _iteratorNormalCompletion6 = true;\n            var _didIteratorError6 = false;\n            var _iteratorError6 = undefined;\n\n            try {\n                for (var _iterator6 = result[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {\n                    var item = _step6.value;\n\n                    var itemId = item.get('product').objectId;\n                    cart.items.get(itemId).id = item.id;\n\n                    itemsPointers.push({ \"__type\": \"Pointer\", \"className\": \"OrderItem\", \"objectId\": item.id });\n                }\n\n                //console.log(cart.items);\n                //console.log(itemsPointers);\n            } catch (err) {\n                _didIteratorError6 = true;\n                _iteratorError6 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion6 && _iterator6.return) {\n                        _iterator6.return();\n                    }\n                } finally {\n                    if (_didIteratorError6) {\n                        throw _iteratorError6;\n                    }\n                }\n            }\n\n            if (cart.hasOwnProperty('id')) {\n                consumerCart.set('id', cart.id);\n            }\n\n            if (typeof paymentMethod != 'undefined') {\n                consumerCart.set('paymentMethod', paymentMethod.method);\n            }\n\n            consumerCart.set('consumerAddress', {\n                __type: \"Pointer\",\n                className: \"ConsumerAddress\",\n                objectId: address.objectId\n            });\n            consumerCart.set('consumer', {\n                __type: \"Pointer\",\n                className: \"Consumer\",\n                objectId: consumer.objectId\n            });\n            consumerCart.set('items', itemsPointers);\n\n            consumerCart.save(undefined, {\n                success: function success(result) {\n                    /*delete userBuffer.address;\n                     delete userBuffer.location;\n                     delete userBuffer['address-name'];\n                      console.log(userBuffer);\n                     console.log('\\nConsumer kart');\n                     console.log(result);\n                    */\n                    cart['id'] = result.id;\n                    cart['rawParseObject'] = result;\n                    cart['itemsPointers'] = itemsPointers;\n                },\n                error: function error(user, _error6) {\n                    // Execute any logic that should take place if the save fails.\n                    // error is a Parse.Error with an error code and message.\n                    console.log('Failed to create new object, with error code: ' + _error6.message);\n                }\n            });\n        },\n        error: function error(user, _error7) {\n            // Execute any logic that should take place if the save fails.\n            // error is a Parse.Error with an error code and message.\n            console.log('Failed to create new object, with error code: ' + _error7.message);\n        }\n    });\n}\n\nfunction saveOrder(recipientId) {\n    var order = new ParseModels.Order();\n    var consumer = getData(recipientId, 'consumer');\n    var customer = getData(recipientId, 'customer');\n    var cart = getData(recipientId, 'cart');\n    var address = getData(recipientId, 'address');\n    var paymentMethod = getData(recipientId, 'paymentMethod');\n    var pointSale = getData(recipientId, 'pointSale');\n    var state0 = orderStates.get(0);\n    var total = 0;\n\n    /*console.log(consumer);\n    console.log(consumer.name);\n    console.log(customer);\n    console.log(paymentMethod.method);\n    console.log(address);\n    console.log(state0);\n    console.log(cart);\n    console.log(pointSale);*/\n\n    cart.items.forEach(function (value, key) {\n        //console.log(value);\n        total += value.quantity * value.price;\n    });\n\n    order.set('consumer', { __type: 'Pointer', className: 'Consumer', objectId: consumer.objectId });\n    order.set('consumerAddress', { __type: 'Pointer', className: 'ConsumerAddress', objectId: address.objectId });\n    order.set('pointSale', { __type: 'Pointer', className: 'CustomerPointSale', objectId: pointSale.objectId });\n    order.set('state', { __type: 'Pointer', className: 'OrderState', objectId: state0.objectId });\n    //order.set('dateSchedule')\n    order.set('items', cart.itemsPointers);\n    order.set('deliveryCost', pointSale.deliveryCost);\n    order.set('total', total);\n    order.set('paymentMethod', paymentMethod.method);\n    order.set('name', consumer.name);\n    //order.set('comment', \"Orden\");\n\n    console.log('Setting Order');\n\n    order.save(undefined, {\n        success: function success(order) {\n\n            store.dispatch(Actions.setOrder(recipientId, order)).then(function () {\n                console.log('Save Order');\n                console.log(order);\n            });\n\n            console.log('Save Order');\n            console.log(order);\n        },\n        error: function error(user, _error8) {\n            // Execute any logic that should take place if the save fails.\n            // error is a Parse.Error with an error code and message.\n            console.log('Failed to create new object, with error code: ' + _error8.message);\n            console.log(_error8);\n        }\n    });\n}\n\nfunction renderAddProductConfirmation(recipientId, productId) {\n    return new Parse.Query(ParseModels.Product).get(productId).then(function (product) {\n        var messageData = {\n            recipient: {\n                id: recipientId\n            },\n            message: {\n                \"text\": \"El producto \" + product.get('name') + \" ha sido agregado.\\n\\nDeseas agregar otro producto o terminar tu pedido?\",\n                \"quick_replies\": [{\n                    \"content_type\": \"text\",\n                    \"title\": \"Seguir pidiendo\",\n                    \"payload\": \"SendCategories-0\"\n                }, {\n                    \"content_type\": \"text\",\n                    \"title\": \"Ver carrito\",\n                    \"payload\": \"SendCart\"\n                }]\n            }\n        };\n        bot.sendTypingOff(recipientId);\n        bot.callSendAPI(messageData);\n    }, function (object, error) {\n        console.log(error);\n        // error is an instance of Parse.Error.\n    });\n}\n\nfunction sendPurchaseOptions(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Tenemos las siguientes opciones disponibles:\",\n            \"quick_replies\": [{\n                \"content_type\": \"text\",\n                \"title\": \"Ver categorias\",\n                \"payload\": \"SendCategories-0\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"Ver carrito\",\n                \"payload\": \"SendCart\"\n            }]\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction sendCart(recipientId) {\n    authentication(recipientId, function () {\n        // Generate a random receipt ID as the API requires a unique ID\n\n        var user = getData(recipientId, 'user');\n        var customer = getData(recipientId, 'customer');\n        var consumer = getData(recipientId, 'consumer');\n        var cart = getData(recipientId, 'cart');\n        var address = getData(recipientId, 'address');\n        var customer_image_url;\n        /*\n        console.log('sendCart');\n        console.log(user);\n        console.log('customer');\n        console.log(customer);\n        console.log('consumer');\n        console.log(consumer);\n        console.log('cart');\n        console.log(cart);\n        console.log('address');\n        console.log(address);\n        */\n\n        if (typeof customer != 'undefined') {\n            customer_image_url = customer.image.url;\n        }\n\n        if (cart == undefined) {\n            cart = createCart(recipientId);\n        }\n\n        var items = cart.items;\n\n        bot.sendTypingOn(recipientId);\n\n        var elements = [];\n        var element = {};\n        var total = 0;\n        var orderLimit = items.size;\n        var ind = 0;\n        var image;\n        var image_url;\n\n        //console.log('Shopping Cart');\n        //console.log(orderLimit);\n        if (orderLimit == 0) {\n            renderCartEmpty(recipientId);\n        } else {\n            items.forEach(function (value, key) {\n                var product = new Parse.Query(ParseModels.Product);\n\n                product.get(key, {\n                    success: function success(item) {\n                        image = item.get('image');\n                        image_url = customer_image_url;\n                        if (image) {\n                            image_url = image.url();\n                        }\n\n                        element = {};\n                        element['title'] = item.get('name');\n                        element['subtitle'] = item.get('description');\n                        element['quantity'] = value.quantity;\n                        element['price'] = parseInt(item.get('priceDefault'));\n                        element['currency'] = \"COP\";\n                        element['image_url'] = image_url;\n\n                        elements.push(element);\n                        total += element['quantity'] * element['price'];\n\n                        ind++;\n\n                        if (ind == orderLimit) {\n                            renderCart(recipientId, cart.id, elements, total);\n                        }\n                    },\n                    error: function error(_error9) {\n                        alert(\"Error: \" + _error9.code + \" \" + _error9.message);\n                    }\n                });\n            });\n        }\n    });\n}\n\nfunction renderCart(recipientId, cartId, elements, total) {\n    var user = getData(recipientId, 'user');\n    var consumer = getData(recipientId, 'consumer');\n    var address = getData(recipientId, 'address');\n    var pointSale = getData(recipientId, 'pointSale');\n    var payment_method = getData(recipientId, 'payment_method');\n    var addressData = undefined;\n\n    if (typeof payment_method == 'undefined') {\n        payment_method = { name: 'Sin definir' };\n    }\n\n    if (typeof address != 'undefined') {\n        addressData = {\n            street_1: address.address,\n            street_2: \"\",\n            city: address.city,\n            postal_code: address.postalCode,\n            state: address.state,\n            country: address.countryCode\n        };\n    }\n\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            attachment: {\n                type: \"template\",\n                payload: {\n                    template_type: \"receipt\",\n                    recipient_name: user.first_name + \" \" + user.last_name,\n                    order_number: cartId,\n                    currency: \"COP\",\n                    payment_method: payment_method.name,\n                    order_url: \"http://petersapparel.parseapp.com/order?order_id=123456\",\n                    timestamp: Math.trunc(Date.now() / 1000).toString(),\n                    elements: elements,\n                    address: addressData,\n                    summary: {\n                        subtotal: total,\n                        shipping_cost: pointSale.deliveryCost,\n                        //total_tax: 0,\n                        total_cost: total + pointSale.deliveryCost\n                    }\n                    //adjustments: [{\n                    //  name: \"New Customer Discount\",\n                    //  amount: -1000\n                    //}, {\n                    //    name: \"$1000 Off Coupon\",\n                    //    amount: -1000\n                    //}]\n                }\n            },\n            \"quick_replies\": [{\n                \"content_type\": \"text\",\n                \"title\": \"Finalizar pedido\",\n                \"payload\": \"CheckOrder\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"Seguir Pidiendo\",\n                \"payload\": \"SendCategories-0\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"Modificar carrito\",\n                \"payload\": \"SendCartDetails\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"Borrar carrito\",\n                \"payload\": \"ClearCart\"\n            }]\n        }\n    };\n\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction sendCartDetails(recipientId) {\n    bot.sendTypingOn(recipientId);\n    renderCartDetails(recipientId);\n}\n\nfunction renderCartDetails(recipientId) {\n    var cart = getData(recipientId, 'cart');\n    var customer = getData(recipientId, 'customer');\n    var consumer = getData(recipientId, 'consumer');\n    var image_url = customer.image.url;\n    var items = cart.items;\n    var elements = [];\n\n    items.forEach(function (value, key) {\n        if (elements.length <= bot.limit) {\n            new Parse.Query(ParseModels.Product).get(key).then(function (product) {\n                var image = product.get('image');\n                if (image) {\n                    image_url = image.url();\n                }\n\n                elements.push({\n                    \"title\": product.get('name') + \": $\" + value.price,\n                    \"subtitle\": \"Cantidad solicitada: \" + value.quantity,\n                    \"image_url\": image_url,\n                    \"buttons\": [{\n                        \"type\": \"postback\",\n                        \"title\": \"Quitar\",\n                        \"payload\": \"RemoveProduct-\" + key\n                    }, {\n                        \"type\": \"postback\",\n                        \"title\": \"Aumentar 1\",\n                        \"payload\": \"IncreaseOneProduct-\" + key\n                    }, {\n                        \"type\": \"postback\",\n                        \"title\": \"Disminuir 1\",\n                        \"payload\": \"DecreaseOneProduct-\" + key\n                    }]\n                });\n\n                if (elements.length == bot.limit || elements.length == items.size) {\n                    var messageData = {\n                        recipient: {\n                            id: recipientId\n                        },\n                        message: {\n                            \"attachment\": {\n                                \"type\": \"template\",\n                                \"payload\": {\n                                    \"template_type\": \"generic\",\n                                    \"elements\": elements\n                                }\n                            }\n                        }\n                    };\n                    bot.sendTypingOff(recipientId);\n                    bot.callSendAPI(messageData, renderEditCartOptions);\n                }\n            });\n        }\n    });\n}\n\nfunction renderEditCartOptions(recipientId) {\n\n    var messageData = {\n        \"recipient\": {\n            \"id\": recipientId\n        },\n        \"message\": {\n            \"text\": \"Opciones del carrito:\",\n            \"quick_replies\": [{\n                \"content_type\": \"text\",\n                \"title\": \"Finalizar pedido\",\n                \"payload\": \"CheckOrder\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"Seguir Pidiendo\",\n                \"payload\": \"SendCategories-0\"\n            }]\n        }\n    };\n\n    bot.callSendAPI(messageData);\n}\n\nfunction renderCartEmpty(recipientId) {\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Tu carrito de compras está vacío.\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData, sendPurchaseOptions);\n}\n\nfunction editCart(recipientId) {\n    var cart = getData(recipientId, 'cart');\n\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"attachment\": {\n                \"type\": \"template\",\n                \"payload\": {\n                    \"template_type\": \"generic\",\n                    \"elements\": [{\n                        \"title\": \"Opciones\",\n                        //\"item_url\": \"https://petersfancyapparel.com/classic_white_tshirt\",\n                        \"image_url\": SERVER_URL + \"assets/thinking.jpg\",\n                        //\"subtitle\": \"Soft white cotton t-shirt is back in style\",\n                        \"buttons\": [{\n                            \"type\": \"web_url\",\n                            \"url\": SERVER_URL + \"cart?\" + cart.id,\n                            \"title\": \"Remover producto\",\n                            \"webview_height_ratio\": \"tall\"\n                        }]\n                    }]\n                }\n            }\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction clearCart(recipientId) {\n    var cart = getData(recipientId, 'cart');\n\n    if (typeof cart == 'undefined') {} else {\n        var items = cart.items;\n        cart.itemsPointers = [];\n\n        items.forEach(function (value, key) {\n            new Parse.Query(ParseModels.OrderItem).get(value.id, {\n                success: function success(orderItem) {\n                    orderItem.destroy({});\n                    items.delete(key);\n                    if (items.size == 0) {\n                        sendCart(recipientId);\n                    }\n                },\n                error: function error(orderItem, _error10) {\n                    console.log('error');\n                    console.log(_error10);\n                }\n            });\n        });\n    }\n}\n\nfunction checkOrder(recipientId) {\n    checkPayment(recipientId);\n}\n\nfunction checkPayment(recipientId) {\n    bot.sendTypingOn(recipientId);\n    store.dispatch(Actions.loadPaymentMethods(recipientId)).then(function () {\n        renderCheckPayment(recipientId);\n    });\n}\n\nfunction checkAddress(recipientId) {}\n\nfunction renderCheckPayment(recipientId) {\n    var paymentMethods = getData(recipientId, 'paymentMethods');\n    var quick_replies = [];\n\n    console.log(paymentMethods);\n\n    for (var i in paymentMethods) {\n\n        quick_replies.push({\n            \"content_type\": \"text\",\n            \"title\": paymentMethods[i].name.substring(0, 20),\n            \"payload\": \"Checkout-\" + paymentMethods[i].objectId\n        });\n    }\n    //console.log(quick_replies);\n\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Como vas a pagar tu pedido? (Tu pedido se cobra cuando lo recibes)\",\n            \"quick_replies\": quick_replies\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction checkout(recipientId, id) {\n    bot.sendTypingOn(recipientId);\n    console.log('checkout');\n    console.log(id);\n\n    store.dispatch(Actions.setPaymentMethod(recipientId, id)).then(function () {\n\n        var paymentMethod = getData(recipientId, 'paymentMethod');\n        console.log(paymentMethod);\n        var paymentFunction = paymentTypes.get(paymentMethod.method.objectId);\n        console.log(paymentFunction);\n\n        paymentFunction(recipientId);\n        /*\n        var cart = new ParseModels.Order();\n        cart.set('name', userBuffer['address-name']);\n        cart.set('address', userBuffer.address);\n        cart.set('consumer', {\n            __type: \"Pointer\",\n            className: \"Consumer\",\n            objectId: consumer.objectId\n        });\n          cart.save(undefined, {\n            success: function(result) {\n                 delete userBuffer.address;\n                delete userBuffer.location;\n                delete userBuffer['address-name'];\n                 console.log(userBuffer);\n                 console.log('Consumer Address');\n             },\n            error: function(user, error) {\n                // Execute any logic that should take place if the save fails.\n                // error is a Parse.Error with an error code and message.\n                console.log('Failed to create new object, with error code: ' + error.message);\n            }\n        });\n        */\n    });\n}\n\nfunction setPayment(recipientId, id) {}\n\nfunction renderCash(recipientId) {\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Se ha registrado el pago en efectivo\"\n        }\n    };\n\n    saveCart(recipientId);\n\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData, orderConfirmation);\n}\n\nfunction renderCreditCard(recipientId) {\n    var creditCards = getData(recipientId, 'creditCards');\n    var consumer = getData(recipientId, 'consumer');\n\n    if (!_.isEmpty(consumer.user)) {\n        store.dispatch(Actions.loadUserCreditCards(recipientId, consumer.user)).then(function () {\n            sendRegisteredCreditCards(recipientId);\n        });\n    }\n}\n\nfunction registerCreditCard(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var consumer = getData(recipientId, 'consumer');\n\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"attachment\": {\n                \"type\": \"template\",\n                \"payload\": {\n                    \"template_type\": \"generic\",\n                    \"elements\": [{\n                        \"title\": \"Registro de tarjeta de credito y finalización de tu pedido.\\n\\nEstas de acuerdo?\",\n                        \"image_url\": SERVER_URL + \"assets/money.jpg\",\n                        \"subtitle\": \"Por razones de seguridad te redireccionaremos a una página web segura.\",\n                        \"buttons\": [{\n                            \"type\": \"web_url\",\n                            \"title\": \"Si\",\n                            \"url\": SERVER_URL + \"creditcard?id=\" + consumer.objectId,\n                            \"webview_height_ratio\": \"tall\"\n                        }, {\n                            \"type\": \"postback\",\n                            \"title\": \"No\",\n                            \"payload\": \"CancelRegisterCreditCard\"\n                        }]\n                    }]\n                }\n            }\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction cancelRegisterCreditCard(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Si no ingresas los datos de tu tarjeta en nuestro sitio seguro, no podras comprar con tarjeta online\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData, checkPayment);\n}\n\nfunction sendRegisteredCreditCards(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var consumer = getData(recipientId, 'consumer');\n\n    store.dispatch(Actions.loadUserCreditCards(recipientId, consumer.user)).then(function () {\n        var creditCards = getData(recipientId, 'creditCards');\n        if (creditCards.length == 0) {\n            //saveCart(recipientId);\n            renderNoRegisteredCreditCards(recipientId);\n        } else {\n            renderRegisteredCreditCards(recipientId);\n        }\n    });\n}\n\nfunction renderNoRegisteredCreditCards(recipientId) {\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Aun no tienes tarjetas registradas, deseas registrar una tarjeta?\",\n            \"quick_replies\": [{\n                \"content_type\": \"text\",\n                \"title\": \"Si\",\n                \"payload\": \"RegisterCreditCard\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"No\",\n                \"payload\": \"CheckPayment\"\n            }]\n        }\n    };\n\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction renderRegisteredCreditCards(recipientId) {\n    var creditCards = getData(recipientId, 'creditCards');\n    var quick_replies = [];\n\n    quick_replies.push({\n        \"content_type\": \"text\",\n        \"title\": \"Agregar tarjeta\",\n        \"payload\": \"RegisterCreditCard\"\n    });\n\n    var _iteratorNormalCompletion7 = true;\n    var _didIteratorError7 = false;\n    var _iteratorError7 = undefined;\n\n    try {\n        for (var _iterator7 = creditCards[Symbol.iterator](), _step7; !(_iteratorNormalCompletion7 = (_step7 = _iterator7.next()).done); _iteratorNormalCompletion7 = true) {\n            var card = _step7.value;\n\n            if (quick_replies.length < bot.limit) {\n                quick_replies.push({\n                    \"content_type\": \"text\",\n                    \"title\": card.type + \" \" + card.lastFour,\n                    \"payload\": \"PayWithCreditCard-\" + card.lastFour\n                });\n            }\n        }\n    } catch (err) {\n        _didIteratorError7 = true;\n        _iteratorError7 = err;\n    } finally {\n        try {\n            if (!_iteratorNormalCompletion7 && _iterator7.return) {\n                _iterator7.return();\n            }\n        } finally {\n            if (_didIteratorError7) {\n                throw _iteratorError7;\n            }\n        }\n    }\n\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Con cual tarjeta quieres pagar?\",\n            \"quick_replies\": quick_replies\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction payWithCreditCard(recipientId, creditCardId) {\n    bot.sendTypingOn(recipientId);\n    console.log(creditCardId);\n\n    orderConfirmation(recipientId);\n}\n\nfunction orderConfirmation(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var state0 = orderStates.get(0);\n\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": state0.messagePush + \"\\n\\nEn un momento te estaremos dando información en tiempo real sobre tu pedido\"\n        }\n    };\n\n    saveOrder(recipientId);\n\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction orderState(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Tu pedido ha sido Aceptado. \\n\\nLo estan preparando en nuestra sede y te lo enviaremos en aproximadamente 10 minutos\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData, orderSent);\n}\n\nfunction orderSent(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Buenas noticias, Tu pedido ha sido Enviado. \\n\\nHaz click en el mapa para vel tu pedido\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData, serviceRating);\n}\n\nfunction renderOrderState(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var orderState = getData(recipientId, 'orderState');\n\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": orderState.messagePush\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    if (orderState.order == 5) {\n        bot.callSendAPI(messageData, serviceRating);\n    } else if (orderState.order == 6) {} else {\n        bot.callSendAPI(messageData);\n    }\n}\n\nfunction serviceRating(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Califica tu experiencia para ayudarnos a mejorar. \\n\\nDe 1 a 5 cuantas extrellas merece nuestro servicio?\",\n            \"quick_replies\": [{\n                \"content_type\": \"text\",\n                \"title\": \"5 (Excelente)\",\n                \"payload\": \"SetScore-5\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"4 (Bien)\",\n                \"payload\": \"SetScore-4\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"3 (Regular)\",\n                \"payload\": \"SetScore-3\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"2 (Mal)\",\n                \"payload\": \"SetScore-2\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"2 (Muy mal)\",\n                \"payload\": \"SetScore-1\"\n            }]\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction setScore(recipientId, score) {\n    var order = getData(recipientId, 'order');\n\n    bot.sendTypingOn(recipientId);\n\n    Parse.Cloud.run('rateOrder', { orderId: order.objectId, score: Number(score), comment: '' }).then(function (result) {\n        thank(recipientId);\n    }, function (error) {\n        console.log('error');\n        console.log(error);\n    });\n}\n\nfunction thank(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Gracias, esperamos tener el gusto de atenderle nuevamente\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction searchProducts(recipientId, query, index) {\n    bot.sendTypingOn(recipientId);\n\n    Parse.Cloud.run('search', { businessId: BUSINESS_ID, q: query }).then(function (result) {\n        if (result.length == 0) {\n            renderSearchEmpty(recipientId);\n        } else if (result.length == 1 && result[0].type == 'Category') {\n            sendProducts(recipientId, result[0].id, 0);\n        } else {\n            if (index == undefined) index = 0;else if (typeof index == 'string') index = parseInt(index);\n\n            if (index == 0) {\n                renderSearchInitial(recipientId);\n                bot.sendTypingOn(recipientId);\n            }\n\n            var elements = splitSearchResult(recipientId, result, index);\n            var idx = Object.keys(result).length;\n            var buttons = [];\n            var catIni = (index + 1) * bot.limit;\n            var catFin = idx > catIni + bot.limit ? catIni + bot.limit : idx;\n\n            if (idx > (index + 1) * bot.limit) {\n                buttons.push({\n                    type: \"postback\",\n                    title: \"Productos \" + (catIni + 1) + \"-\" + catFin,\n                    payload: \"Search-\" + (index + 1)\n                });\n\n                elements.push({\n                    title: \"Ver más productos \",\n                    subtitle: \"Productos disponibles\",\n                    buttons: buttons\n                });\n            }\n\n            var messageData = {\n                recipient: {\n                    id: recipientId\n                },\n                message: {\n                    attachment: {\n                        type: \"template\",\n                        payload: {\n                            template_type: \"generic\",\n                            elements: elements\n                        }\n                    }\n                }\n            };\n\n            bot.sendTypingOff(recipientId);\n            bot.callSendAPI(messageData);\n        }\n    }, function (error) {\n        console.log('error');\n        console.log(error);\n    });\n}\n\nfunction renderSearchInitial(recipientId) {\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Se han encontrado los siguientes productos:\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction renderSearchEmpty(recipientId) {\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"No se han encontrado productos que coincidan\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction splitSearchResult(recipientId, products, index) {\n    var customer = getData(recipientId, 'customer');\n    var image_url = customer.image.url;\n    var idx = 0;\n    var elements = [];\n\n    products.forEach(function (item) {\n        if (item && item.name && item.type == 'Product') {\n            //item.id get Product information\n            if (idx >= index * bot.limit && idx < (index + 1) * bot.limit) {\n                var image = item.image;\n                if (image) {\n                    image_url = image.url();\n                }\n                elements.push({\n                    title: item.name,\n                    //subtitle: item.get('name'),\n                    //item_url: \"http://www.mycolombianrecipes.com/fruit-cocktail-salpicon-de-frutas\",\n                    image_url: image_url,\n                    buttons: [{\n                        type: \"postback\",\n                        title: 'Agregar',\n                        payload: \"AddProduct-\" + item.id\n                    }]\n                });\n                idx = idx + 1;\n            }\n        }\n    });\n    return elements;\n}\n\nfunction sendHelp(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"InOut Bot.\\n\\nTe permite visualizar las opciones de productos, agregarlos al carrito y realizar tu compra por medio del chat de facebook.\\n\\nFuncionalidades disponibles: \\n\\n'Hola', para iniciar la conversación\\n'Pedir Domicilio', si quieres realizar un domicilio\\n'Carrito', para ver el estado actual de tu carrito\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData, sendContactUs);\n}\n\nfunction sendContactUs(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \" Para mayor información puedes contactarnos en:\\n\\n Web: http://www.inoutdelivery.com/\\n\\n Email: john.garavito@inoutdelivery.com\"\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction sendRegisterFacebookUser(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Registro exitoso.\"\n\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction sendOrders(recipientId) {\n    bot.sendTypingOn(recipientId);\n    var user = getData(recipientId, 'user');\n    var consumer = getData(recipientId, 'consumer');\n\n    if (typeof consumer == 'undefined') {\n        store.dispatch(Actions.loadCustomer(recipientId, BUSINESS_ID)).then(function () {\n            /*authentication(recipientId, user => {\n                if(user){\n                    store.dispatch(Actions.loadConsumer(recipientId, user)).then(\n                        () => {\n                            consumer = getData(recipientId, 'consumer');\n                            store.dispatch(Actions.loadConsumerAddresses(recipientId, consumer.rawParseObject)).then(\n                                () => {\n                                    renderAddressMenu(recipientId);\n                                }\n                            );\n                        }\n                    );\n                }\n            });*/\n        });\n    } else {\n        console.log('user');\n        console.log(user.rawParseObject);\n        console.log('consumer');\n        console.log(consumer.rawParseObject);\n        console.log(user.rawParseObject.getSessionToken());\n\n        Parse.Cloud.run('orders', { businessId: BUSINESS_ID }).then(function (result) {\n            console.log(result);\n        }, function (error) {\n            console.log('error');\n            console.log(error);\n        });\n\n        /*\n        request.post({\n            url: PARSE_SERVER_URL+'/functions/orders',\n            headers: {\n                'Content-Type': 'text/plain;charset=UTF-8',\n                'X-Parse-Application-Id': PARSE_APP_ID,\n                'X-Parse-Session-Token': user.rawParseObject.getSessionToken()\n            }\n        }, function callback(error, response, body) {\n            if (!error && response.statusCode == 200) {\n                console.log(body);\n            }\n            else{\n                console.log(response.statusCode);\n                console.log('error');\n                console.log(error);\n            }\n        });\n         */\n\n        store.dispatch(Actions.loadConsumerOrders(recipientId, consumer.rawParseObject)).then(function () {\n            renderOrders(recipientId);\n        });\n    }\n}\n\nfunction renderOrders(recipientId) {\n    var orders = getData(recipientId, 'orders');\n    var elements = [];\n\n    console.log(orders);\n\n    elements.push({\n        \"title\": \"Nueva orden\",\n        \"subtitle\": \"Puedes realizar una orden\",\n        \"image_url\": SERVER_URL + \"assets/conversation.jpg\",\n        \"buttons\": [{\n            \"type\": \"postback\",\n            \"title\": \"Nueva orden\",\n            \"payload\": \"NewOrder\"\n        }]\n    });\n\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"attachment\": {\n                \"type\": \"template\",\n                \"payload\": {\n                    \"template_type\": \"generic\",\n                    \"elements\": elements\n                }\n            }\n        }\n    };\n\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction newOrder(recipientId) {\n    clearCart(recipientId);\n    sendAddresses(recipientId);\n}\n\nfunction renderShoppingCartOptions(recipientId) {\n    var messageData = {\n        recipient: {\n            id: recipientId\n        },\n        message: {\n            \"text\": \"Opciones del carrito\",\n            \"quick_replies\": [{\n                \"content_type\": \"text\",\n                \"title\": \"Finalizar pedido\",\n                \"payload\": \"CheckOrder\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"Seguir Pidiendo\",\n                \"payload\": \"SendCategories-0\"\n            }, {\n                \"content_type\": \"text\",\n                \"title\": \"Borrar carrito\",\n                \"payload\": \"ClearCart\"\n            }]\n        }\n    };\n    bot.sendTypingOff(recipientId);\n    bot.callSendAPI(messageData);\n}\n\nfunction updateCart(recipientId) {\n    var consumerCart = new ParseModels.Cart();\n    var localCart = getData(recipientId, 'cart');\n\n    new Parse.Query(consumerCart).get(localCart.id).then(function (cart) {\n        //console.log('updateCart');\n        console.log(cart);\n    }, function (object, error) {\n        console.log(error);\n        // error is an instance of Parse.Error.\n    });\n}\n\nbot.app.post('/CreditCardRegistered', function (req, res) {\n    var data = req.body;\n    sendRegisteredCreditCards(data.recipientId);\n});\n\nbot.app.get('/creditcard', function (req, res) {\n    res.sendFile(_path2.default.join(__dirname + '/views/cardForm.html'));\n});\n\nbot.app.post('/registerCreditCard', function (req, res) {\n    var User = Parse.Object.extend('User');\n    var Consumer = Parse.Object.extend('Consumer');\n    var data = req.body;\n    var consumerID = data['consumerID'];\n\n    console.log('registerCreditCard');\n\n    new Parse.Query(Consumer).get(consumerID).then(function (consumer) {\n        if (consumer) {\n            new Parse.Query(User).get(consumer.get('user').id).then(function (user) {\n                var username = user.get('username');\n                var recipientId = user.get('facebookId');\n                Parse.User.logIn(username, username, {\n                    success: function success(userData) {\n                        var expiry = data['expiry'].replace(/\\s+/g, \"\").split('/');\n\n                        _request2.default.post({\n                            url: PARSE_SERVER_URL + '/functions/addCreditCard',\n                            headers: {\n                                'Content-Type': 'text/plain;charset=UTF-8',\n                                'X-Parse-Application-Id': PARSE_APP_ID,\n                                'X-Parse-Session-Token': userData.getSessionToken()\n                            },\n                            json: { \"number\": data['number'].replace(/\\s+/g, \"\"),\n                                \"verificationNumber\": data['CCV'],\n                                \"expirationMonth\": expiry[0],\n                                \"expirationYear\": expiry[1],\n                                \"holderName\": data['first-name'] + ' ' + data['last-name']\n                            }\n                        }, function callback(error, response, body) {\n                            if (!error && response.statusCode == 200) {\n\n                                _request2.default.post({\n                                    url: SERVER_URL + 'CreditCardRegistered',\n                                    json: { \"recipientId\": recipientId }\n                                });\n                            } else {\n                                console.log(response.statusCode);\n                                console.log('error');\n                                console.log(error);\n                            }\n                        });\n                    },\n                    error: function error(user, _error11) {\n                        console.log('error');\n                        console.log(_error11);\n                    }\n                });\n            });\n\n            res.sendFile(_path2.default.join(__dirname + '/views/cardRegistered.html'));\n        }\n    }, function (object, error) {\n        console.log(error);\n    });\n});\n\nbot.app.post('/changeOrderState', function (req, res) {\n\n    var data = req.body;\n\n    new Parse.Query(ParseModels.Consumer).get(data['consumerID']).then(function (consumer) {\n        if (consumer) {\n            new Parse.Query(ParseModels.User).get(consumer.get('user').id).then(function (user) {\n                var username = user.get('username');\n                var recipientId = user.get('facebookId');\n\n                new Parse.Query(ParseModels.OrderState).get(data['stateID']).then(function (orderState) {\n                    store.dispatch(Actions.setOrderState(recipientId, orderState)).then(function () {\n                        renderOrderState(recipientId);\n                    });\n                }).fail(function (error) {\n                    console.log('Error code: ' + error.message);\n                });\n            });\n        }\n    }, function (object, error) {\n        console.log(error);\n    });\n\n    /*\n      Parse.Cloud.run('orders').then(\n     function(result){\n     console.log(result);\n     },\n     function(error) {\n     console.log('error');\n     console.log(error);\n     });\n        request.get({\n        url: PARSE_SERVER_URL+'/classes/Order?where:{\"objectId\":\"'+data['orderID']+'\"}',\n        headers: {\n            'Content-Type': 'text/plain;charset=UTF-8',\n            'X-Parse-Application-Id': PARSE_APP_ID,\n        }\n    }, function callback(error, response, body) {\n        console.log('get order')\n        console.log(body)\n    });\n    */\n    res.json({ result: 'OK' });\n});\n\nvar paymentTypes = new Map();\n\nnew Parse.Query(ParseModels.PaymentMethod).find().then(function (methods) {\n    var _iteratorNormalCompletion8 = true;\n    var _didIteratorError8 = false;\n    var _iteratorError8 = undefined;\n\n    try {\n        for (var _iterator8 = methods[Symbol.iterator](), _step8; !(_iteratorNormalCompletion8 = (_step8 = _iterator8.next()).done); _iteratorNormalCompletion8 = true) {\n            var method = _step8.value;\n\n            var tmpMethod = (0, _ParseUtils.extractParseAttributes)(method);\n            if (tmpMethod.objectId == 'Nn0joKC5VK') {\n                paymentTypes.set('Nn0joKC5VK', renderCash);\n            } else if (tmpMethod.objectId == 'UdK0Ifc4IF') {\n                paymentTypes.set('UdK0Ifc4IF', renderCreditCard);\n            }\n            //orderStates.set(state.get('order'), extractParseAttributes(state));\n        }\n    } catch (err) {\n        _didIteratorError8 = true;\n        _iteratorError8 = err;\n    } finally {\n        try {\n            if (!_iteratorNormalCompletion8 && _iterator8.return) {\n                _iterator8.return();\n            }\n        } finally {\n            if (_didIteratorError8) {\n                throw _iteratorError8;\n            }\n        }\n    }\n}, function (object, error) {\n    console.log(error);\n});\n\nvar orderStates = new Map();\n\nnew Parse.Query(ParseModels.OrderState).find().then(function (states) {\n    var _iteratorNormalCompletion9 = true;\n    var _didIteratorError9 = false;\n    var _iteratorError9 = undefined;\n\n    try {\n        for (var _iterator9 = states[Symbol.iterator](), _step9; !(_iteratorNormalCompletion9 = (_step9 = _iterator9.next()).done); _iteratorNormalCompletion9 = true) {\n            var state = _step9.value;\n\n            orderStates.set(state.get('order'), (0, _ParseUtils.extractParseAttributes)(state));\n        }\n    } catch (err) {\n        _didIteratorError9 = true;\n        _iteratorError9 = err;\n    } finally {\n        try {\n            if (!_iteratorNormalCompletion9 && _iterator9.return) {\n                _iterator9.return();\n            }\n        } finally {\n            if (_didIteratorError9) {\n                throw _iteratorError9;\n            }\n        }\n    }\n}, function (object, error) {\n    console.log(error);\n});\n\n//orderStates.set('HUIPd800xH', { __type: 'Pointer', className: 'OrderState', objectId: 'HUIPd800xH' });\n\nstore.dispatch({ type: types.APP_LOADED });\n\n/*\nconsole.log('Exist FB.init: '+( typeof FB.init === 'function') );\nconsole.log(FB.getLoginUrl({ scope: 'user_about_me' }));\n\n Parse.FacebookUtils.init({ // this line replaces FB.init({\n appId      : FACEBOOK_APP_ID, // Facebook App ID\n cookie     : true,  // enable cookies to allow Parse to access the session\n xfbml      : true,  // initialize Facebook social plugins on the page\n version    : 'v2.4' // point to the latest Facebook Graph API version\n });\n */"]}